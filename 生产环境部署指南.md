# æ”¯ä»˜ç®¡ç†ç³»ç»Ÿç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜å¦‚ä½•å°†æ”¯ä»˜ç®¡ç†ç³»ç»Ÿéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼ŒåŒ…æ‹¬æœåŠ¡å™¨é…ç½®ã€å®‰å…¨è®¾ç½®ã€æ€§èƒ½ä¼˜åŒ–å’Œç›‘æ§é…ç½®ã€‚

## ğŸ¯ éƒ¨ç½²ç›®æ ‡

- âœ… é«˜å¯ç”¨æ€§å’Œç¨³å®šæ€§
- âœ… å®‰å…¨æ€§é…ç½®
- âœ… æ€§èƒ½ä¼˜åŒ–
- âœ… ç›‘æ§å’Œæ—¥å¿—
- âœ… å¤‡ä»½å’Œæ¢å¤

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
ç”¨æˆ·è¯·æ±‚ â†’ Nginx (åå‘ä»£ç†) â†’ Node.js åº”ç”¨ â†’ SQLite/MySQL æ•°æ®åº“
                â†“
            é™æ€æ–‡ä»¶æœåŠ¡ (React æ„å»ºæ–‡ä»¶)
```

## ğŸ“¦ ç¯å¢ƒè¦æ±‚

### æœåŠ¡å™¨è¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 20.04+ / CentOS 8+ / macOS
- **å†…å­˜**: æœ€å°‘ 2GB RAM
- **å­˜å‚¨**: æœ€å°‘ 10GB å¯ç”¨ç©ºé—´
- **ç½‘ç»œ**: ç¨³å®šçš„ç½‘ç»œè¿æ¥

### è½¯ä»¶è¦æ±‚
- **Node.js**: 16.x æˆ–æ›´é«˜ç‰ˆæœ¬
- **npm**: 8.x æˆ–æ›´é«˜ç‰ˆæœ¬
- **PM2**: è¿›ç¨‹ç®¡ç†å™¨
- **Nginx**: åå‘ä»£ç†æœåŠ¡å™¨
- **SSLè¯ä¹¦**: HTTPSæ”¯æŒ

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### 1. æœåŠ¡å™¨å‡†å¤‡

```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# å®‰è£…Node.js
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# å®‰è£…Nginx
sudo apt install nginx -y

# å®‰è£…PM2
sudo npm install -g pm2
```

### 2. é¡¹ç›®éƒ¨ç½²

```bash
# å…‹éš†é¡¹ç›®
git clone <your-repository-url>
cd payment-management-system

# è¿è¡Œéƒ¨ç½²è„šæœ¬
chmod +x deploy-production.sh
./deploy-production.sh
```

### 3. ç¯å¢ƒé…ç½®

ç¼–è¾‘ `server/.env` æ–‡ä»¶ï¼Œé…ç½®ç”Ÿäº§ç¯å¢ƒå‚æ•°ï¼š

```env
# ç”Ÿäº§ç¯å¢ƒé…ç½®
NODE_ENV=production
PORT=5000

# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=3306
DB_NAME=payment_management
DB_USER=payment_user
DB_PASSWORD=your_secure_password

# JWTé…ç½®
JWT_SECRET=your_super_secure_jwt_secret_key_for_production
JWT_EXPIRES_IN=24h

# å®‰å…¨é…ç½®
CORS_ORIGIN=https://yourdomain.com
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX=100
```

### 4. å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨ç”Ÿäº§ç¯å¢ƒæœåŠ¡
./start-production.sh

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
pm2 status
pm2 logs
```

### 5. Nginxé…ç½®

å°† `nginx.conf.example` å¤åˆ¶åˆ° Nginx é…ç½®ç›®å½•ï¼š

```bash
sudo cp nginx.conf.example /etc/nginx/sites-available/payment-management
sudo ln -s /etc/nginx/sites-available/payment-management /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

### 6. SSLè¯ä¹¦é…ç½®

ä½¿ç”¨ Let's Encrypt å…è´¹SSLè¯ä¹¦ï¼š

```bash
# å®‰è£…Certbot
sudo apt install certbot python3-certbot-nginx -y

# è·å–SSLè¯ä¹¦
sudo certbot --nginx -d yourdomain.com -d www.yourdomain.com

# è®¾ç½®è‡ªåŠ¨ç»­æœŸ
sudo crontab -e
# æ·»åŠ : 0 12 * * * /usr/bin/certbot renew --quiet
```

## ğŸ”’ å®‰å…¨é…ç½®

### 1. é˜²ç«å¢™è®¾ç½®

```bash
# é…ç½®UFWé˜²ç«å¢™
sudo ufw allow ssh
sudo ufw allow 'Nginx Full'
sudo ufw enable
```

### 2. å®‰å…¨å¤´é…ç½®

å·²åœ¨ Nginx é…ç½®ä¸­å¯ç”¨çš„å®‰å…¨å¤´ï¼š
- X-Frame-Options: DENY
- X-Content-Type-Options: nosniff
- X-XSS-Protection: 1; mode=block
- Strict-Transport-Security: max-age=31536000

### 3. é€Ÿç‡é™åˆ¶

- APIè¯·æ±‚é™åˆ¶ï¼š100æ¬¡/15åˆ†é’Ÿ
- æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶ï¼š10MB
- ä¼šè¯è¶…æ—¶ï¼š24å°æ—¶

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### 1. ç³»ç»Ÿç›‘æ§

```bash
# è¿è¡Œç›‘æ§è„šæœ¬
./monitor.sh

# æŸ¥çœ‹PM2æ—¥å¿—
pm2 logs payment-management-server

# æŸ¥çœ‹Nginxæ—¥å¿—
sudo tail -f /var/log/nginx/access.log
sudo tail -f /var/log/nginx/error.log
```

### 2. æ€§èƒ½ç›‘æ§

- **å†…å­˜ä½¿ç”¨**: PM2è‡ªåŠ¨ç›‘æ§
- **CPUä½¿ç”¨**: ç³»ç»Ÿç›‘æ§
- **ç£ç›˜ç©ºé—´**: å®šæœŸæ£€æŸ¥
- **ç½‘ç»œæµé‡**: Nginxè®¿é—®æ—¥å¿—

### 3. é”™è¯¯ç›‘æ§

- åº”ç”¨é”™è¯¯æ—¥å¿—ï¼š`logs/err.log`
- è®¿é—®æ—¥å¿—ï¼š`logs/out.log`
- ç»¼åˆæ—¥å¿—ï¼š`logs/combined.log`

## ğŸ’¾ å¤‡ä»½ç­–ç•¥

### 1. è‡ªåŠ¨å¤‡ä»½

```bash
# è®¾ç½®å®šæ—¶å¤‡ä»½ï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹ï¼‰
crontab -e
# æ·»åŠ : 0 2 * * * /path/to/your/project/backup.sh
```

### 2. å¤‡ä»½å†…å®¹

- æ•°æ®åº“æ–‡ä»¶
- ä¸Šä¼ æ–‡ä»¶
- é…ç½®æ–‡ä»¶
- æ—¥å¿—æ–‡ä»¶

### 3. å¤‡ä»½æ¢å¤

```bash
# æ¢å¤å¤‡ä»½
tar -xzf backups/YYYYMMDD_HHMMSS.tar.gz
cp -r YYYYMMDD_HHMMSS/* ./
```

## ğŸ”§ ç»´æŠ¤æ“ä½œ

### 1. æœåŠ¡ç®¡ç†

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
pm2 status

# é‡å¯æœåŠ¡
pm2 restart payment-management-server

# åœæ­¢æœåŠ¡
pm2 stop payment-management-server

# æŸ¥çœ‹æ—¥å¿—
pm2 logs payment-management-server
```

### 2. æ›´æ–°éƒ¨ç½²

```bash
# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# é‡æ–°å®‰è£…ä¾èµ–
cd server && npm install --production
cd ../client && npm install --production && npm run build

# é‡å¯æœåŠ¡
pm2 restart payment-management-server
```

### 3. æ•°æ®åº“ç»´æŠ¤

```bash
# æ•°æ®åº“å¤‡ä»½
./backup.sh

# æ•°æ®åº“ä¼˜åŒ–
cd server
node scripts/migrate.js
```

## ğŸš¨ æ•…éšœæ’é™¤

### 1. å¸¸è§é—®é¢˜

**æœåŠ¡æ— æ³•å¯åŠ¨**
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
sudo netstat -tulpn | grep :5000

# æ£€æŸ¥æ—¥å¿—
pm2 logs payment-management-server
```

**æ•°æ®åº“è¿æ¥å¤±è´¥**
```bash
# æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶æƒé™
ls -la server/database.sqlite

# æ£€æŸ¥æ•°æ®åº“é…ç½®
cat server/.env | grep DB_
```

**Nginxé…ç½®é”™è¯¯**
```bash
# æ£€æŸ¥Nginxé…ç½®
sudo nginx -t

# æŸ¥çœ‹Nginxé”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log
```

### 2. æ€§èƒ½ä¼˜åŒ–

**å†…å­˜ä¸è¶³**
- å¢åŠ æœåŠ¡å™¨å†…å­˜
- ä¼˜åŒ–Node.jså†…å­˜é™åˆ¶
- å¯ç”¨æ•°æ®åº“è¿æ¥æ± 

**å“åº”ç¼“æ…¢**
- å¯ç”¨Gzipå‹ç¼©
- é…ç½®é™æ€æ–‡ä»¶ç¼“å­˜
- ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### è”ç³»ä¿¡æ¯
- **æŠ€æœ¯æ”¯æŒ**: support@yourdomain.com
- **ç´§æ€¥è”ç³»**: emergency@yourdomain.com

### æ–‡æ¡£èµ„æº
- [APIæ–‡æ¡£](./APIæ–‡æ¡£.md)
- [ç”¨æˆ·æ‰‹å†Œ](./ç”¨æˆ·æ‰‹å†Œ.md)
- [å¼€å‘æ–‡æ¡£](./å¼€å‘æ–‡æ¡£.md)

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-12-29)
- âœ… åˆå§‹ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- âœ… å®‰å…¨é…ç½®å®Œæˆ
- âœ… ç›‘æ§ç³»ç»Ÿé…ç½®
- âœ… å¤‡ä»½ç­–ç•¥å®æ–½

---

**æ³¨æ„**: è¯·æ ¹æ®å®é™…ç¯å¢ƒè°ƒæ•´é…ç½®å‚æ•°ï¼Œç¡®ä¿å®‰å…¨æ€§å’Œç¨³å®šæ€§ã€‚ 