# 📋 v2.5.0 综合修复部署清单

## 🎯 修复目标
1. ✅ 修复佣金率更新失败问题
2. ✅ 修复待返佣金额计算逻辑  
3. ✅ 动态佣金率保留两位小数
4. ✅ 排除已拒绝订单的统计

## 📝 修改文件
### `client/src/services/api.js`
- **行 1434-1440**: 添加 `updateCommissionRate` 方法到 AdminAPI 对象
- **行 775-780**: 一级销售订单统计排除已拒绝订单
- **行 943-948**: 二级销售订单统计排除已拒绝订单
- **行 883**: 动态佣金率保留两位小数
- **行 1251-1277**: 修复待返佣金额计算逻辑
- **行 1395**: 使用正确的待返佣金变量

## 🔧 具体修复内容

### 1. 佣金率更新失败
**问题**: `AdminAPI` 对象缺少 `updateCommissionRate` 方法
**解决**: 在 AdminAPI 对象中添加该方法，调用 SalesAPI 的实现

### 2. 待返佣金额计算
**问题**: 待返佣金额显示为0，但实际有待返佣金
**解决**: 待返佣金额 = 应返佣金总额 - 已返佣金总额（当前系统无已返记录，所以待返=应返）

### 3. 动态佣金率显示
**问题**: 佣金率显示小数位过长
**解决**: 使用 `Math.round(rate * 100) / 100` 保留两位小数

### 4. 已拒绝订单过滤
**问题**: 已拒绝的订单被计入统计
**解决**: 在所有订单统计中添加 `order.status !== 'rejected'` 过滤条件

## ✅ 验证要点
1. 管理员销售页面佣金率设置功能正常
2. 待返佣金额正确显示（应等于所有销售的应返佣金总和）
3. 动态佣金率显示为两位小数
4. 数据概览和销售管理不包含已拒绝订单

## 🚀 部署步骤
1. 提交代码到 GitHub
2. Vercel 自动部署
3. 验证线上功能
