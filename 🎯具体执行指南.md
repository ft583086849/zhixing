# 🎯 Supabase SQL执行指南

## 📋 操作步骤

### 1️⃣ 点击 "Public Insert Permission for Admins" 脚本
**执行以下代码（覆盖管理员表策略）：**
```sql
-- 删除旧的管理员策略
DROP POLICY IF EXISTS "Allow public insert admins" ON admins;
DROP POLICY IF EXISTS "Allow insert admins" ON admins;

-- 创建新的管理员策略
CREATE POLICY "Enable insert for all users" ON admins
FOR INSERT 
TO anon, authenticated
WITH CHECK (true);
```

---

### 2️⃣ 点击 "Public Order Creation Policy" 脚本  
**执行以下代码（覆盖订单表策略）：**
```sql
-- 删除旧的订单策略
DROP POLICY IF EXISTS "Allow public insert orders" ON orders;
DROP POLICY IF EXISTS "Allow anonymous create orders" ON orders;
DROP POLICY IF EXISTS "Allow public update orders" ON orders;

-- 创建新的订单策略
CREATE POLICY "Enable insert for all users" ON orders
FOR INSERT
TO anon, authenticated  
WITH CHECK (true);

CREATE POLICY "Enable update for all users" ON orders
FOR UPDATE
TO anon, authenticated
USING (true)
WITH CHECK (true);
```

---

## 🎯 执行顺序

1. **先执行管理员表修复** → Public Insert Permission for Admins
2. **再执行订单表修复** → Public Order Creation Policy

## ✅ 执行完成后

回复："**最终策略修复完成**"，我将立即测试管理员登录和订单创建功能！

---

## 📝 说明
- 这些代码会**覆盖**现有的限制性策略
- **保留**你现有的销售数据（primary_sales, secondary_sales）
- 只修复**管理员表**和**订单表**的权限问题