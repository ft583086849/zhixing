<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¡¹ç›®ç»“æ„å‡è®¾éªŒè¯</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; background: #f5f5f5; }
        .container { max-width: 800px; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .status { padding: 15px; margin: 10px 0; border-radius: 5px; font-weight: bold; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .testing { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        button { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
        button:hover { background: #0056b3; }
        .results { margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px; font-family: monospace; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª é¡¹ç›®ç»“æ„å‡è®¾éªŒè¯</h1>
        <p><strong>å‡è®¾ï¼š</strong>æ·»åŠ æ ¹ç›®å½•index.htmlåï¼ŒVercelä¼šæ­£ç¡®è¯†åˆ«ä¸ºå‰ç«¯é¡¹ç›®ï¼ŒAPIä¹Ÿèƒ½å·¥ä½œ</p>
        
        <div class="status testing" id="status">
            å‡†å¤‡æµ‹è¯• API è¿æ¥æ€§...
        </div>

        <div>
            <button onclick="testAPI('/api/test')">æµ‹è¯• /api/test</button>
            <button onclick="testAPI('/api/health')">æµ‹è¯• /api/health</button>
            <button onclick="testAPI('/api/admin?action=overview')">æµ‹è¯• /api/admin</button>
            <button onclick="runAllTests()">è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
        </div>

        <div class="results" id="results"></div>
    </div>

    <script>
        const statusEl = document.getElementById('status');
        const resultsEl = document.getElementById('results');
        
        async function testAPI(endpoint) {
            statusEl.className = 'status testing';
            statusEl.textContent = `æµ‹è¯•ä¸­: ${endpoint}...`;
            
            try {
                const startTime = performance.now();
                const response = await fetch(endpoint);
                const endTime = performance.now();
                const responseTime = (endTime - startTime).toFixed(0);
                
                const data = await response.text();
                const status = response.status;
                
                let result = `\n[${new Date().toLocaleTimeString()}] ${endpoint}\n`;
                result += `çŠ¶æ€ç : ${status} | å“åº”æ—¶é—´: ${responseTime}ms\n`;
                result += `å“åº”: ${data.substring(0, 200)}${data.length > 200 ? '...' : ''}\n`;
                result += `${'='.repeat(50)}\n`;
                
                resultsEl.textContent += result;
                resultsEl.scrollTop = resultsEl.scrollHeight;
                
                if (status === 200) {
                    statusEl.className = 'status success';
                    statusEl.textContent = `âœ… ${endpoint} æˆåŠŸå“åº”ï¼`;
                } else {
                    statusEl.className = 'status error';
                    statusEl.textContent = `âŒ ${endpoint} è¿”å› ${status}`;
                }
                
                return { endpoint, status, responseTime, data };
                
            } catch (error) {
                const result = `\n[${new Date().toLocaleTimeString()}] ${endpoint}\n`;
                result += `é”™è¯¯: ${error.message}\n`;
                result += `${'='.repeat(50)}\n`;
                
                resultsEl.textContent += result;
                
                statusEl.className = 'status error';
                statusEl.textContent = `âŒ ${endpoint} è¿æ¥å¤±è´¥: ${error.message}`;
                
                return { endpoint, error: error.message };
            }
        }
        
        async function runAllTests() {
            resultsEl.textContent = 'ğŸ§ª å¼€å§‹é¡¹ç›®ç»“æ„å‡è®¾éªŒè¯æµ‹è¯•...\n' + '='.repeat(50) + '\n';
            
            const endpoints = [
                '/api/test',
                '/api/health', 
                '/api/admin?action=overview'
            ];
            
            const results = [];
            for (const endpoint of endpoints) {
                const result = await testAPI(endpoint);
                results.push(result);
                await new Promise(resolve => setTimeout(resolve, 1000)); // 1ç§’é—´éš”
            }
            
            // ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
            const successCount = results.filter(r => r.status === 200).length;
            const totalCount = results.length;
            const successRate = (successCount / totalCount * 100).toFixed(1);
            
            let report = `\nğŸ¯ éªŒè¯ç»“æœæŠ¥å‘Š:\n`;
            report += `æˆåŠŸç‡: ${successRate}% (${successCount}/${totalCount})\n`;
            report += `å‡è®¾éªŒè¯: ${successCount > 0 ? 'âœ… éƒ¨åˆ†æˆåŠŸ - é¡¹ç›®ç»“æ„å½±å“ç¡®å®å­˜åœ¨' : 'âŒ å¤±è´¥ - éœ€è¦å…¶ä»–è§£å†³æ–¹æ¡ˆ'}\n`;
            report += `${'='.repeat(50)}\n`;
            
            resultsEl.textContent += report;
            
            if (successCount > 0) {
                statusEl.className = 'status success';
                statusEl.textContent = `ğŸ‰ å‡è®¾éªŒè¯æˆåŠŸï¼${successCount}ä¸ªAPIå¯ç”¨`;
            } else {
                statusEl.className = 'status error';
                statusEl.textContent = `âŒ å‡è®¾éªŒè¯å¤±è´¥ï¼ŒAPIä»ç„¶ä¸å¯ç”¨`;
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œæµ‹è¯•
        window.onload = function() {
            setTimeout(runAllTests, 1000);
        };
    </script>
</body>
</html>