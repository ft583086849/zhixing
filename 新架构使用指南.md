# ğŸ—ï¸ æ–°æ¶æ„ä½¿ç”¨æŒ‡å—

## ğŸ“ æ–‡ä»¶ç»“æ„
```
client/src/services/
â”œâ”€â”€ supabase.js          # Supabaseæ•°æ®åº“æœåŠ¡å±‚
â”œâ”€â”€ auth.js              # èº«ä»½éªŒè¯æœåŠ¡
â””â”€â”€ api.js               # ç»Ÿä¸€APIä¸šåŠ¡é€»è¾‘å±‚
```

## ğŸ”§ ä¸‰å±‚æ¶æ„è¯´æ˜

### 1. æ•°æ®åº“å±‚ (supabase.js)
- **èŒè´£**: ç›´æ¥ä¸Supabaseæ•°æ®åº“äº¤äº’
- **ç‰¹ç‚¹**: æä¾›åŸå­æ€§æ•°æ®æ“ä½œæ–¹æ³•
- **ä½¿ç”¨åœºæ™¯**: åŸºç¡€CRUDæ“ä½œ

```javascript
import { SupabaseService } from './supabase';

// ç›´æ¥æ•°æ®åº“æ“ä½œ
const orders = await SupabaseService.getOrders();
const admin = await SupabaseService.getAdminByUsername('admin');
```

### 2. è®¤è¯å±‚ (auth.js)
- **èŒè´£**: ç”¨æˆ·èº«ä»½éªŒè¯å’Œæƒé™ç®¡ç†
- **ç‰¹ç‚¹**: ç»Ÿä¸€çš„ç™»å½•/ç™»å‡ºé€»è¾‘
- **ä½¿ç”¨åœºæ™¯**: ç”¨æˆ·ç™»å½•ã€æƒé™æ£€æŸ¥

```javascript
import { AuthService } from './auth';

// ç™»å½•
const result = await AuthService.login('admin', 'password');

// æ£€æŸ¥ç™»å½•çŠ¶æ€
const isLoggedIn = AuthService.isAuthenticated();

// ç™»å‡º
AuthService.logout();
```

### 3. ä¸šåŠ¡é€»è¾‘å±‚ (api.js)
- **èŒè´£**: å¤æ‚ä¸šåŠ¡é€»è¾‘å°è£…å’Œç¼“å­˜ç®¡ç†
- **ç‰¹ç‚¹**: é«˜çº§APIæ¥å£ï¼Œç»Ÿä¸€é”™è¯¯å¤„ç†
- **ä½¿ç”¨åœºæ™¯**: Reactç»„ä»¶è°ƒç”¨

```javascript
import { API } from './api';

// ç®¡ç†å‘˜æ“ä½œ
const overview = await API.Admin.getOverview();
const orders = await API.Admin.getOrders();

// é”€å”®æ“ä½œ
const salesInfo = await API.Sales.getSalesByCode('SALES001');
await API.Sales.registerSecondary(salesData);

// è®¢å•æ“ä½œ
const newOrder = await API.Orders.create(orderData);
await API.Orders.updateStatus(orderId, 'completed');
```

## ğŸ“‹ Reactç»„ä»¶ä½¿ç”¨ç¤ºä¾‹

### ç®¡ç†å‘˜ç™»å½•é¡µé¢
```javascript
import { useState } from 'react';
import { API } from '../services/api';

function AdminLogin() {
  const [loading, setLoading] = useState(false);
  
  const handleLogin = async (credentials) => {
    setLoading(true);
    try {
      const result = await API.Admin.login(credentials);
      if (result.success) {
        // ç™»å½•æˆåŠŸï¼Œè·³è½¬åˆ°ç®¡ç†é¡µé¢
        window.location.href = '/#/admin/dashboard';
      }
    } catch (error) {
      // é”™è¯¯å·²ç»åœ¨APIå±‚å¤„ç†å’Œæ˜¾ç¤º
    } finally {
      setLoading(false);
    }
  };
  
  // ... ç»„ä»¶æ¸²æŸ“
}
```

### è®¢å•åˆ—è¡¨é¡µé¢
```javascript
import { useEffect, useState } from 'react';
import { API } from '../services/api';

function OrdersList() {
  const [orders, setOrders] = useState([]);
  const [loading, setLoading] = useState(true);
  
  useEffect(() => {
    loadOrders();
  }, []);
  
  const loadOrders = async () => {
    try {
      const result = await API.Admin.getOrders();
      if (result.success) {
        setOrders(result.data);
      }
    } catch (error) {
      // é”™è¯¯å·²å¤„ç†
    } finally {
      setLoading(false);
    }
  };
  
  // ... ç»„ä»¶æ¸²æŸ“
}
```

## âœ… æ–°æ¶æ„ä¼˜åŠ¿

1. **æ¸…æ™°çš„èŒè´£åˆ†ç¦»**
   - æ•°æ®åº“æ“ä½œ â†’ Supabaseå±‚
   - ä¸šåŠ¡é€»è¾‘ â†’ APIå±‚
   - è®¤è¯ç®¡ç† â†’ Authå±‚

2. **ç»Ÿä¸€çš„é”™è¯¯å¤„ç†**
   - è‡ªåŠ¨æ˜¾ç¤ºç”¨æˆ·å‹å¥½çš„é”™è¯¯ä¿¡æ¯
   - è‡ªåŠ¨å¤„ç†ç™»å½•è¿‡æœŸ
   - ç»Ÿä¸€çš„é”™è¯¯æ—¥å¿—

3. **æ™ºèƒ½ç¼“å­˜ç®¡ç†**
   - è‡ªåŠ¨ç¼“å­˜é¢‘ç¹æŸ¥è¯¢çš„æ•°æ®
   - æ•°æ®æ›´æ–°æ—¶è‡ªåŠ¨æ¸…é™¤ç›¸å…³ç¼“å­˜
   - æå‡ç”¨æˆ·ä½“éªŒ

4. **æ˜“äºç»´æŠ¤å’Œæ‰©å±•**
   - æ¨¡å—åŒ–è®¾è®¡ï¼Œä¾¿äºæ·»åŠ æ–°åŠŸèƒ½
   - æ¸…æ™°çš„APIæ¥å£ï¼Œä¾¿äºå›¢é˜Ÿåä½œ
   - å®Œæ•´çš„ç±»å‹æç¤ºå’Œæ–‡æ¡£

## ğŸ”„ è¿ç§»æ­¥éª¤

1. **æ›¿æ¢å¯¼å…¥**
   ```javascript
   // æ—§æ–¹å¼
   import api from '../services/api';
   
   // æ–°æ–¹å¼
   import { API } from '../services/api';
   ```

2. **æ›´æ–°APIè°ƒç”¨**
   ```javascript
   // æ—§æ–¹å¼
   const response = await api.get('/admin?action=overview');
   
   // æ–°æ–¹å¼
   const result = await API.Admin.getOverview();
   ```

3. **å¤„ç†è¿”å›å€¼**
   ```javascript
   // æ–°APIç»Ÿä¸€è¿”å›æ ¼å¼
   const result = await API.Admin.getOrders();
   if (result.success) {
     setOrders(result.data);
   }
   ```

## ğŸš€ ç«‹å³å¼€å§‹ä½¿ç”¨
æ–°æ¶æ„å·²ç»å®Œå…¨å…¼å®¹ç°æœ‰åŠŸèƒ½ï¼Œå¯ä»¥ç«‹å³å¼€å§‹ä½¿ç”¨ï¼