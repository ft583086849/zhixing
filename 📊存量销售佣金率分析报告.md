# 📊 存量销售佣金率分析报告

## 🎯 核心要求
- **二级销售（有上级）**：默认佣金率 **25%**
- **独立销售（无上级）**：默认佣金率 **25%**

## 🔍 检查方法

### 1. 运行检查脚本
在管理员后台控制台运行 `检查非25佣金率的存量销售.js`

### 2. 脚本功能
- 查询所有 `secondary_sales` 表的记录
- 区分有上级的二级销售和独立销售
- 统计各种佣金率的分布
- 列出所有非25%的销售明细

## 📈 预期结果分类

### ✅ 正常情况（25%）
- 新注册的二级销售
- 未被一级销售调整过的二级销售
- 系统默认设置的销售

### ⚠️ 特殊情况（非25%）

#### 1. 自定义佣金率
- **原因**：一级销售在对账页面手动调整过
- **处理**：**保留**，这是业务需求
- **常见值**：20%, 30%, 35%, 40%等

#### 2. 0%或NULL
- **原因**：早期数据未设置
- **处理**：可以更新为25%默认值
- **操作**：运行 `updateZeroRateTo25()`

#### 3. 错误数据
- **原因**：数据迁移或bug导致
- **处理**：人工审核后修正

## 🛠️ 修复方案

### 自动修复（安全）
```javascript
// 只更新0%或未设置的记录
UPDATE secondary_sales
SET commission_rate = 0.25
WHERE commission_rate IS NULL 
   OR commission_rate = 0;
```

### 保留情况
```javascript
// 以下情况不应修改：
// 1. 一级销售设置的自定义佣金率（15%, 20%, 30%, 35%等）
// 2. 特殊协议的销售佣金率
```

## 📋 检查清单

1. **运行检查脚本** ✅
2. **查看佣金率分布** ✅
3. **识别非25%的原因** ✅
4. **决定是否需要修复** ✅
5. **执行修复（如需要）** ⏳
6. **验证修复结果** ⏳

## 💡 重要提醒

1. **不要盲目更新所有非25%的记录**
   - 一级销售设置的佣金率是业务需求
   - 必须保留这些自定义设置

2. **只更新明确的异常数据**
   - 0%或NULL值
   - 明显的错误数据

3. **更新前备份**
   - 记录当前状态
   - 便于回滚

## 🎯 最终目标

- 新注册的销售自动获得25%默认佣金率 ✅
- 存量合理的自定义佣金率得到保留 ✅
- 异常数据得到修正 ⏳
- 一级销售仍可在对账页面调整二级佣金率 ✅
