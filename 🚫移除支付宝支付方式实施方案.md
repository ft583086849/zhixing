# ğŸš« ç§»é™¤æ”¯ä»˜å®æ”¯ä»˜æ–¹å¼ - å®Œæ•´å®æ–½æ–¹æ¡ˆ

## ğŸ“‹ å½±å“èŒƒå›´åˆ†æ

### 1. å‰ç«¯é¡µé¢éœ€è¦ä¿®æ”¹
- **ä¸€çº§é”€å”®æ³¨å†Œé¡µé¢** (`client/src/pages/SalesPage.js`)
- **äºŒçº§é”€å”®æ³¨å†Œé¡µé¢** (`client/src/pages/UnifiedSecondarySalesPage.js`) 
- **ç”¨æˆ·è´­ä¹°é¡µé¢** (`client/src/pages/PurchasePage.js`)
- **ç®¡ç†å‘˜é…ç½®é¡µé¢** (`client/src/components/admin/AdminPaymentConfig.js`)
- **ç®¡ç†å‘˜é”€å”®ç®¡ç†** (`client/src/components/admin/AdminSales.js`)
- **ç®¡ç†å‘˜è®¢å•ç®¡ç†** (`client/src/components/admin/AdminOrders.js`)
- **ä¸€çº§é”€å”®ç»“ç®—é¡µé¢** (`client/src/pages/PrimarySalesSettlementPage.js`)

### 2. æ•°æ®åº“è¡¨éœ€è¦ä¿®æ”¹
- **primary_salesè¡¨**: ç§»é™¤æ”¯ä»˜å®ç›¸å…³å­—æ®µ
- **secondary_salesè¡¨**: ç§»é™¤æ”¯ä»˜å®ç›¸å…³å­—æ®µ  
- **payment_configè¡¨**: ç§»é™¤ç®¡ç†å‘˜æ”¯ä»˜å®é…ç½®å­—æ®µ
- **ordersè¡¨**: æ›´æ–°payment_methodæšä¸¾å€¼

### 3. åç«¯APIéœ€è¦ä¿®æ”¹
- **services/api.js**: ç§»é™¤æ”¯ä»˜å®ç›¸å…³å¤„ç†é€»è¾‘
- **services/supabase.js**: æ›´æ–°æ•°æ®åº“æ“ä½œ

## ğŸ”§ å…·ä½“ä¿®æ”¹å†…å®¹

### ä¸€ã€å‰ç«¯ä¿®æ”¹

#### 1. é”€å”®æ³¨å†Œé¡µé¢ï¼ˆä¸€çº§å’ŒäºŒçº§ï¼‰
```javascript
// åˆ é™¤æ”¯ä»˜å®é€‰é¡¹
<Select>
  {/* <Option value="alipay">æ”¯ä»˜å®</Option> */}
  <Option value="crypto">é“¾ä¸Šåœ°å€</Option>
</Select>

// åˆ é™¤æ”¯ä»˜å®ç›¸å…³è¡¨å•å­—æ®µ
{/* åˆ é™¤ä»¥ä¸‹ä»£ç å—
{paymentMethod === 'alipay' && (
  <>
    <Form.Item name="payment_address" label="æ”¯ä»˜å®è´¦å·">
      ...
    </Form.Item>
    <Form.Item name="name" label="æ”¶æ¬¾äººå§“æ°">
      ...
    </Form.Item>
  </>
)}
*/}
```

#### 2. ç”¨æˆ·è´­ä¹°é¡µé¢
```javascript
// ç§»é™¤æ”¯ä»˜å®é»˜è®¤é€‰é¡¹
const [paymentMethod, setPaymentMethod] = useState('crypto'); // æ”¹ä¸ºé»˜è®¤crypto

// åˆ é™¤æ”¯ä»˜å®ç›¸å…³æ˜¾ç¤ºé€»è¾‘
```

#### 3. ç®¡ç†å‘˜é…ç½®é¡µé¢
```javascript
// åˆ é™¤æ•´ä¸ªæ”¯ä»˜å®é…ç½®å¡ç‰‡
{/* åˆ é™¤ä»¥ä¸‹ä»£ç å—
<Card title="æ”¯ä»˜å®æ”¶æ¬¾é…ç½®">
  ...
</Card>
*/}
```

### äºŒã€æ•°æ®åº“ä¿®æ”¹

#### 1. æ›´æ–°è¡¨ç»“æ„
```sql
-- 1. æ›´æ–°ordersè¡¨çš„payment_methodæšä¸¾
ALTER TABLE orders 
MODIFY COLUMN payment_method ENUM('crypto') DEFAULT 'crypto';

-- 2. ç§»é™¤primary_salesè¡¨çš„æ”¯ä»˜å®å­—æ®µï¼ˆå¦‚æœå­˜åœ¨ï¼‰
-- æ³¨æ„ï¼šéœ€è¦å…ˆæ£€æŸ¥æ˜¯å¦æœ‰æ•°æ®ä¾èµ–

-- 3. ç§»é™¤secondary_salesè¡¨çš„æ”¯ä»˜å®å­—æ®µï¼ˆå¦‚æœå­˜åœ¨ï¼‰
-- æ³¨æ„ï¼šéœ€è¦å…ˆæ£€æŸ¥æ˜¯å¦æœ‰æ•°æ®ä¾èµ–

-- 4. ç§»é™¤payment_configè¡¨çš„æ”¯ä»˜å®å­—æ®µ
ALTER TABLE payment_config
DROP COLUMN alipay_account,
DROP COLUMN alipay_name,
DROP COLUMN alipay_qr_code;
```

### ä¸‰ã€æ•°æ®è¿ç§»ç­–ç•¥

#### 1. ç°æœ‰æ”¯ä»˜å®æ•°æ®å¤„ç†
```sql
-- å¤‡ä»½ç°æœ‰æ”¯ä»˜å®æ•°æ®
CREATE TABLE backup_alipay_data AS
SELECT 
  id,
  sales_code,
  payment_method,
  payment_address,
  name
FROM primary_sales
WHERE payment_method = 'alipay';

-- å°†ç°æœ‰æ”¯ä»˜å®ç”¨æˆ·è¿ç§»åˆ°crypto
UPDATE primary_sales
SET payment_method = 'crypto'
WHERE payment_method = 'alipay';

UPDATE secondary_sales  
SET payment_method = 'crypto'
WHERE payment_method = 'alipay';

UPDATE orders
SET payment_method = 'crypto'
WHERE payment_method = 'alipay';
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ•°æ®å¤‡ä»½**: ä¿®æ”¹å‰å¿…é¡»å¤‡ä»½æ‰€æœ‰ç›¸å…³æ•°æ®
2. **åˆ†æ­¥æ‰§è¡Œ**: å»ºè®®å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯
3. **ç”¨æˆ·é€šçŸ¥**: å¦‚æœ‰æ­£åœ¨ä½¿ç”¨æ”¯ä»˜å®çš„é”€å”®ï¼Œéœ€æå‰é€šçŸ¥
4. **è®¢å•å¤„ç†**: ç¡®ä¿æ‰€æœ‰å¾…å¤„ç†çš„æ”¯ä»˜å®è®¢å•å·²å®Œæˆ
5. **å›æ»šæ–¹æ¡ˆ**: å‡†å¤‡å¥½å›æ»šè„šæœ¬ä»¥é˜²å‡ºç°é—®é¢˜

## ğŸ“ å®æ–½æ­¥éª¤

1. **ç¬¬ä¸€æ­¥**: å¤‡ä»½æ•°æ®åº“
2. **ç¬¬äºŒæ­¥**: æ‰§è¡Œæ•°æ®è¿ç§»è„šæœ¬
3. **ç¬¬ä¸‰æ­¥**: æ›´æ–°å‰ç«¯ä»£ç 
4. **ç¬¬å››æ­¥**: æ›´æ–°åç«¯API
5. **ç¬¬äº”æ­¥**: æµ‹è¯•æ‰€æœ‰åŠŸèƒ½
6. **ç¬¬å…­æ­¥**: éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

## ğŸ¯ é¢„æœŸç»“æœ

- æ‰€æœ‰é”€å”®æ³¨å†Œåªæ”¯æŒ"é“¾ä¸Šåœ°å€"ä¸€ç§æ”¶æ¬¾æ–¹å¼
- ç®¡ç†å‘˜ä¸å†æœ‰æ”¯ä»˜å®é…ç½®é€‰é¡¹
- ç”¨æˆ·è´­ä¹°æ—¶åªèƒ½é€‰æ‹©é“¾ä¸Šåœ°å€æ”¯ä»˜
- å†å²æ”¯ä»˜å®æ•°æ®è‡ªåŠ¨è¿ç§»åˆ°é“¾ä¸Šåœ°å€

## ğŸ“Š å½±å“è¯„ä¼°

- **å½±å“ç”¨æˆ·æ•°**: éœ€è¦ç»Ÿè®¡å½“å‰ä½¿ç”¨æ”¯ä»˜å®çš„é”€å”®æ•°é‡
- **å½±å“è®¢å•æ•°**: éœ€è¦ç»Ÿè®¡å¾…å¤„ç†çš„æ”¯ä»˜å®è®¢å•
- **ç³»ç»Ÿåœæœºæ—¶é—´**: é¢„è®¡30åˆ†é’Ÿå®Œæˆæ‰€æœ‰ä¿®æ”¹å’Œéƒ¨ç½²
