# MCPæ•°æ®å’Œé€»è¾‘è®°å½•
> é¡¹ç›®ï¼šçŸ¥è¡Œè´¢åº“ (Wé¡¹ç›®)
> æ›´æ–°æ—¶é—´ï¼š2025-01-13
> ç”¨é€”ï¼šä¾›MCPå·¥å…·ç†è§£é¡¹ç›®æ•°æ®ç»“æ„å’Œä¸šåŠ¡é€»è¾‘

## æ ¸å¿ƒæ•°æ®ç»“æ„

### æ•°æ®åº“è¡¨ç»“æ„
```
orders (è®¢å•è¡¨)
â”œâ”€â”€ id
â”œâ”€â”€ order_number (è®¢å•å·)
â”œâ”€â”€ sales_code (é”€å”®ä»£ç )
â”œâ”€â”€ tradingview_username (TVç”¨æˆ·å)
â”œâ”€â”€ customer_wechat (å®¢æˆ·å¾®ä¿¡)
â”œâ”€â”€ amount (è®¢å•é‡‘é¢)
â”œâ”€â”€ actual_payment_amount (å®é™…æ”¯ä»˜é‡‘é¢)
â”œâ”€â”€ payment_method (æ”¯ä»˜æ–¹å¼: crypto)
â”œâ”€â”€ duration (æ—¶é•¿: 7days/1month/3months/6months/1year)
â”œâ”€â”€ status (çŠ¶æ€)
â”œâ”€â”€ commission_rate (ä½£é‡‘ç‡)
â”œâ”€â”€ commission_amount (ä½£é‡‘é‡‘é¢)
â”œâ”€â”€ config_confirmed (é…ç½®ç¡®è®¤)
â”œâ”€â”€ screenshot_data (æˆªå›¾ - é—®é¢˜ï¼šå…¨éƒ¨NULL)
â””â”€â”€ created_at/updated_at

secondary_sales (é”€å”®è¡¨ - åŒ…å«æ‰€æœ‰ç±»å‹é”€å”®)
â”œâ”€â”€ id
â”œâ”€â”€ sales_code (é”€å”®ä»£ç )
â”œâ”€â”€ wechat_name (å¾®ä¿¡å)
â”œâ”€â”€ sales_type (ç±»å‹: primary/secondary/independent)
â”œâ”€â”€ commission_rate (ä½£é‡‘ç‡: 0-1å°æ•°)
â”œâ”€â”€ payment_method (æ”¶æ¬¾æ–¹å¼)
â”œâ”€â”€ payment_address (æ”¶æ¬¾åœ°å€)
â”œâ”€â”€ chain_name (é“¾å: TRC20/ERC20/BSC)
â”œâ”€â”€ primary_sales_id (ä¸Šçº§é”€å”®ID)
â””â”€â”€ created_at

âš ï¸ primary_salesè¡¨ - ä¸å­˜åœ¨ä½†ä»£ç å¤§é‡å¼•ç”¨
```

### ä½£é‡‘è®¡ç®—è§„åˆ™
```javascript
// ä¸€çº§é”€å”®
ç›´é”€ä½£é‡‘ = è®¢å•é‡‘é¢ * 40%
åˆ†é”€åˆ©æ¶¦ = è®¢å•é‡‘é¢ * (40% - äºŒçº§ä½£é‡‘ç‡)

// äºŒçº§é”€å”®
ä½£é‡‘ = è®¢å•é‡‘é¢ * commission_rate (0-25%)

// ç‹¬ç«‹é”€å”®
ä½£é‡‘ = è®¢å•é‡‘é¢ * commission_rate (0-25%)
```

### å…³é”®ä¸šåŠ¡é€»è¾‘

#### 1. è®¢å•æµç¨‹
```
ç”¨æˆ·ä¸‹å• â†’ ä¸Šä¼ æˆªå›¾ â†’ ç®¡ç†å‘˜ç¡®è®¤æ”¯ä»˜ â†’ é…ç½®æƒé™ â†’ è®¢å•å®Œæˆ
```

#### 2. é”€å”®å±‚çº§
```
ä¸€çº§é”€å”®(40%å›ºå®š)
    â”œâ”€â”€ äºŒçº§é”€å”®A(0-25%å¯è°ƒ)
    â”œâ”€â”€ äºŒçº§é”€å”®B(0-25%å¯è°ƒ)
    â””â”€â”€ ç‹¬ç«‹é”€å”®C(0-25%å¯è°ƒ)
```

#### 3. çŠ¶æ€æµè½¬
```
pending_payment â†’ confirmed_payment â†’ pending_config â†’ confirmed_config â†’ active
```

## å½“å‰ç³»ç»Ÿé—®é¢˜

### ğŸ”´ ä¸¥é‡é—®é¢˜
1. **primary_salesè¡¨ä¸å­˜åœ¨**
   - 15å¤„ä»£ç å¼•ç”¨ä¸å­˜åœ¨çš„è¡¨
   - å¯¼è‡´ä¸€çº§é”€å”®åŠŸèƒ½å¤±æ•ˆ

2. **æˆªå›¾æ•°æ®ä¸¢å¤±**
   - screenshot_dataå…¨éƒ¨ä¸ºNULL
   - ç®¡ç†å‘˜æ— æ³•æŸ¥çœ‹ä»˜æ¬¾å‡­è¯

3. **ä½£é‡‘è®¡ç®—ä¸ä¸€è‡´**
   - ä¸åŒé¡µé¢è®¡ç®—é€»è¾‘ä¸åŒ
   - å¯¼è‡´æ˜¾ç¤ºé‡‘é¢ä¸ä¸€è‡´

### ğŸŸ¡ ä¸­ç­‰é—®é¢˜
1. sales_idå­—æ®µåˆ†è£‚(primary_sales_id/secondary_sales_id)
2. ç¼ºå°‘registration_codeã€link_codeå­—æ®µ
3. äºŒçº§é”€å”®é“¾æ¥ç¡¬ç¼–ç 

### ğŸŸ¢ ä½ä¼˜å…ˆçº§
1. ç»Ÿè®¡å­—æ®µéœ€è¦å®æ—¶è®¡ç®—ï¼Œå½±å“æ€§èƒ½

## APIå…³é”®ä¿¡æ¯

### Supabaseé…ç½®
```javascript
URL: https://itvmeamoqthfqtkpubdv.supabase.co
ç”Ÿäº§ç¯å¢ƒ: https://zhixing-seven.vercel.app
```

### å…³é”®æ–‡ä»¶ä½ç½®
- æ•°æ®åº“æ“ä½œ: client/src/services/supabase.js
- ä¸šåŠ¡é€»è¾‘: client/src/services/api.js
- è´­ä¹°é¡µé¢: client/src/pages/PurchasePage.js
- é”€å”®ç®¡ç†: client/src/components/admin/AdminSales.js

## ä¿®å¤å†å²
- v2.11.1 (2025-01-07): å›æ»šä½£é‡‘è®¡ç®—é€»è¾‘
- v2.12.0: ä½£é‡‘ç³»ç»Ÿv2.0ï¼ŒåŒºåˆ†ç›´é”€å’Œåˆ†é”€
- é”€å”®ç®¡ç†æŒ‰åˆ›å»ºæ—¶é—´é™åºæ’åºå·²å®ç°
- å®¢æˆ·ç®¡ç†æŒ‰æœ€æ–°è®¢å•æ—¶é—´æ’åºå·²å®ç°

## æ³¨æ„äº‹é¡¹
1. ä¿®æ”¹å‰åŠ¡å¿…å¤‡ä»½
2. æµ‹è¯•ç¯å¢ƒéªŒè¯åå†ä¸Šçº¿
3. æ³¨æ„ç¼“å­˜æ¸…ç†(Vercelç¼“å­˜é—®é¢˜)
4. ä½£é‡‘è®¡ç®—ä¼˜å…ˆä½¿ç”¨æ•°æ®åº“å€¼ï¼Œå…¶æ¬¡å®æ—¶è®¡ç®—