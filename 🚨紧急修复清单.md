# 🚨 紧急修复清单

## 1. 重新应用确认订单逻辑修复

### 修改文件：`client/src/services/api.js`

#### 需要修改的位置：
1. **第437行和511行**：
```javascript
// 原：
['confirmed', 'confirmed_configuration', 'active']
// 改为：
['confirmed', 'confirmed_configuration', 'confirmed_config', 'active']
```

2. **第671行**：
```javascript
// 原：
['confirmed_configuration', 'active']
// 改为：
['confirmed_configuration', 'confirmed_config', 'active']
```

3. **第687行**（佣金计算）：
```javascript
// 添加confirmed_config到佣金计算条件
if (['confirmed', 'confirmed_configuration', 'confirmed_config', 'active'].includes(order.status))
```

## 2. 修复二级销售注册页面BUG

### 修改文件：`client/src/pages/UnifiedSecondarySalesPage.js`

#### 问题1：链上地址表单字段错误（第258-290行左右）
```javascript
// 错误的代码：
{(paymentMethod === 'crypto' || !paymentMethod) && (
  <>
    <Form.Item
      name="name"  // ❌ 错误
      label="收款人姓名"  // ❌ 错误
      rules={[{ required: true, message: '请输入收款人姓名' }]}
    >
      <Input placeholder="请输入收款人姓名" size="large" />
    </Form.Item>
  </>
)}

// 应该改为：
{(paymentMethod === 'crypto' || !paymentMethod) && (
  <>
    <Form.Item
      name="crypto_chain_name"  // ✅ 正确
      label="链名"  // ✅ 正确
      rules={[{ required: true, message: '请输入链名' }]}
    >
      <Input placeholder="例如：TRC10/TRC20" size="large" />
    </Form.Item>
    
    <Form.Item
      name="crypto_address"  // ✅ 正确
      label="链上地址"  // ✅ 正确
      rules={[{ required: true, message: '请输入链上地址' }]}
    >
      <Input placeholder="请输入链上地址" size="large" />
    </Form.Item>
  </>
)}
```

#### 问题2：收款方式默认值问题
检查Select组件的defaultValue是否正确设置

## 3. 影响评估

### 对88测试员一级的影响：
- ❌ 当前状态：确认订单金额还是0
- ✅ 修复后：确认订单金额显示$188，佣金$75.2

### 对数据概览的影响：
- ❌ 当前状态：销售返佣金额、业绩都是0
- ✅ 修复后：正确显示统计数据

### 对二级销售注册的影响：
- ❌ 当前状态：无法正确注册链上地址收款方式
- ✅ 修复后：可以正常注册

## 4. 部署优先级

1. **最高优先级**：修复二级销售注册页面（影响新用户注册）
2. **高优先级**：修复确认订单逻辑（影响财务统计）

---
更新时间：2025-01-14
