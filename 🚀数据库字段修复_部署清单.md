# ğŸš€ æ•°æ®åº“å­—æ®µä¿®å¤åŠŸèƒ½ - éƒ¨ç½²æ¸…å•

## ğŸ“‹ ä¿®æ”¹å†…å®¹

### 1. ä¿®æ”¹æ–‡ä»¶
- **api/admin.js** - æ·»åŠ æ–°çš„APIç«¯ç‚¹å’Œå¤„ç†å‡½æ•°

### 2. æ–°å¢æ–‡ä»¶  
- **ä¸€é”®ä¿®å¤æ•°æ®åº“å­—æ®µ.js** - è‡ªåŠ¨åŒ–ä¿®å¤è„šæœ¬

## ğŸ”§ å…·ä½“ä¿®å¤å†…å®¹

### APIç«¯ç‚¹æ–°å¢
- **è·¯å¾„**: `POST /api/admin?path=fix-missing-fields`
- **åŠŸèƒ½**: è‡ªåŠ¨æ£€æµ‹å¹¶æ·»åŠ ç¼ºå¤±çš„æ•°æ®åº“å­—æ®µ
- **æƒé™**: éœ€è¦ç®¡ç†å‘˜è®¤è¯

### ä¿®å¤çš„å­—æ®µ
**ordersè¡¨ (15ä¸ªå­—æ®µ):**
- sales_code, sales_type, customer_wechat
- purchase_type, effective_time, expiry_time  
- alipay_amount, crypto_amount
- commission_rate, commission_amount
- primary_sales_id, secondary_sales_id
- config_confirmed, is_reminded, reminder_date

**secondary_salesè¡¨ (6ä¸ªå­—æ®µ):**
- sales_code, primary_sales_id, primary_registration_code
- commission_rate, status, sales_type

**primary_salesè¡¨ (4ä¸ªå­—æ®µ):**
- sales_code, secondary_registration_code
- commission_rate, sales_type

### ç´¢å¼•ä¼˜åŒ–
- idx_orders_sales_code
- idx_orders_status  
- idx_orders_config_confirmed
- idx_orders_is_reminded
- idx_secondary_sales_code
- idx_primary_sales_code

## ğŸ¯ é¢„æœŸæ•ˆæœ

### ä¿®å¤çš„é—®é¢˜
1. âœ… è®¢å•ç®¡ç†é¡µé¢é”€å”®å¾®ä¿¡å·æ˜¾ç¤ºä¸ºç©º â†’ æ­£å¸¸æ˜¾ç¤º
2. âœ… æ•°æ®æ¦‚è§ˆã€é”€å”®ç®¡ç†ã€å®¢æˆ·ç®¡ç†æ— æ•°æ® â†’ æ­£å¸¸æ˜¾ç¤ºæ•°æ®
3. âœ… æœç´¢åŠŸèƒ½æ— æ³•éªŒè¯ â†’ æ­£å¸¸å·¥ä½œ
4. âœ… æ—¶é—´èŒƒå›´åŠŸèƒ½æ— æ³•éªŒè¯ â†’ æ­£å¸¸å·¥ä½œ
5. âœ… è®¢å•çŠ¶æ€è‹±æ–‡æ˜¾ç¤º â†’ ä¸­æ–‡æ­£å¸¸æ˜¾ç¤º

### APIçŠ¶æ€å˜åŒ–
- **ä¿®å¤å‰**: æ‰€æœ‰ç®¡ç†å‘˜APIè¿”å›500é”™è¯¯ï¼ˆå­—æ®µç¼ºå¤±ï¼‰
- **ä¿®å¤å**: æ‰€æœ‰ç®¡ç†å‘˜APIæ­£å¸¸è¿”å›æ•°æ®

## ğŸš€ éƒ¨ç½²åæ“ä½œ

1. **è¿è¡Œä¿®å¤è„šæœ¬**:
   ```bash
   node ä¸€é”®ä¿®å¤æ•°æ®åº“å­—æ®µ.js
   ```

2. **éªŒè¯ä¿®å¤æ•ˆæœ**:
   - è®¿é—®ç®¡ç†å‘˜é¡µé¢å„ä¸ªåŠŸèƒ½
   - ç¡®è®¤æ•°æ®æ­£å¸¸æ˜¾ç¤º
   - æµ‹è¯•æœç´¢å’Œç­›é€‰åŠŸèƒ½

## âš ï¸ é£é™©è¯„ä¼°

- **é£é™©çº§åˆ«**: ä½
- **å½±å“èŒƒå›´**: ä»…æ·»åŠ å­—æ®µï¼Œä¸åˆ é™¤ç°æœ‰æ•°æ®
- **å›æ»šæ–¹æ¡ˆ**: å­—æ®µæ·»åŠ æ“ä½œç›¸å¯¹å®‰å…¨ï¼Œå¦‚éœ€å›æ»šå¯æ‰‹åŠ¨åˆ é™¤å­—æ®µ

## ğŸ‰ æˆåŠŸæ ‡å‡†

- [ ] APIéƒ¨ç½²æˆåŠŸ
- [ ] ä¿®å¤è„šæœ¬è¿è¡ŒæˆåŠŸ  
- [ ] æ‰€æœ‰ç®¡ç†å‘˜APIæ­£å¸¸å·¥ä½œ
- [ ] ç”¨æˆ·è§‚å¯Ÿåˆ°çš„é—®é¢˜å…¨éƒ¨è§£å†³

---

**å‡†å¤‡éƒ¨ç½²**: è¯·ç¡®è®¤æ˜¯å¦å¯ä»¥è¿›è¡Œéƒ¨ç½²ï¼Ÿ