"use strict";(self.webpackChunkzhixing=self.webpackChunkzhixing||[]).push([[604],{8604:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Ce});var n=r(5043),i=r(9456),l=r(3216),s=r(8964),a=r(9126),d=r(5206),o=r(6051),c=r(5520),x=r(4768),h=r(3722),m=r(4524),u=r(6160),j=r(6840),p=r(3761),y=r(8040),A=r(579);class g extends n.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error("\ud83d\udd25 \u9519\u8bef\u8fb9\u754c\u6355\u83b7\u5230\u9519\u8bef:",e),console.error("\ud83d\udd25 \u9519\u8bef\u4fe1\u606f:",t),this.setState({error:e,errorInfo:t})}render(){var e,t,r,n;return this.state.hasError?(0,A.jsxs)("div",{style:{background:"#fff2f0",border:"2px solid #ff4d4f",borderRadius:"8px",padding:"20px",margin:"20px 0"},children:[(0,A.jsx)("h2",{style:{color:"#ff4d4f",margin:"0 0 10px 0"},children:"\ud83d\udd25 \u7ec4\u4ef6\u53d1\u751f\u9519\u8bef\uff01"}),(0,A.jsxs)("div",{style:{background:"#f5f5f5",padding:"15px",borderRadius:"4px",marginBottom:"15px"},children:[(0,A.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#333"},children:"\u9519\u8bef\u8be6\u60c5\uff1a"}),(0,A.jsxs)("p",{style:{margin:"5px 0",color:"#666"},children:[(0,A.jsx)("strong",{children:"\u9519\u8bef\u540d\u79f0:"})," ",null===(e=this.state.error)||void 0===e?void 0:e.name]}),(0,A.jsxs)("p",{style:{margin:"5px 0",color:"#666"},children:[(0,A.jsx)("strong",{children:"\u9519\u8bef\u6d88\u606f:"})," ",null===(t=this.state.error)||void 0===t?void 0:t.message]}),(0,A.jsx)("p",{style:{margin:"5px 0",color:"#666"},children:(0,A.jsx)("strong",{children:"\u9519\u8bef\u5806\u6808:"})}),(0,A.jsx)("pre",{style:{background:"#fff",padding:"10px",borderRadius:"4px",fontSize:"12px",overflow:"auto",maxHeight:"200px"},children:null===(r=this.state.error)||void 0===r?void 0:r.stack})]}),(0,A.jsxs)("div",{style:{background:"#e6f7ff",padding:"15px",borderRadius:"4px",marginBottom:"15px"},children:[(0,A.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#1890ff"},children:"\u7ec4\u4ef6\u5806\u6808\u4fe1\u606f\uff1a"}),(0,A.jsx)("pre",{style:{background:"#fff",padding:"10px",borderRadius:"4px",fontSize:"12px",overflow:"auto",maxHeight:"200px"},children:null===(n=this.state.errorInfo)||void 0===n?void 0:n.componentStack})]}),(0,A.jsx)("button",{onClick:()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.reload()},style:{background:"#1890ff",color:"white",border:"none",padding:"10px 20px",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},children:"\ud83d\udd04 \u91cd\u65b0\u52a0\u8f7d\u9875\u9762"})]}):this.props.children}}const _=g;var v=r(1023),f=r(7734),w=r(1686),k=r(5397),b=r(6603),Y=r(7419),I=r(1645),C=r(6612),S=r(8354),D=r(7692),z=r(119),M=r(6237),$=r(6401),F=r(5929),R=r(8818),T=r(2101);const{Title:B}=v.A,{RangePicker:E}=f.A,H=()=>{const e=(0,i.wA)(),{stats:t,loading:r}=(0,i.d4)(e=>e.admin),{admin:l}=(0,i.d4)(e=>e.auth),[s,a]=(0,n.useState)("all"),[d,c]=(0,n.useState)([]);(0,n.useEffect)(()=>{l&&("custom"===s&&d.length>0?e((0,T.GT)({timeRange:"custom",customRange:d})):e((0,T.GT)({timeRange:s})))},[e,s,d,l]);return(0,A.jsxs)("div",{children:[(0,A.jsx)(B,{level:2,children:"\u6570\u636e\u6982\u89c8"}),r&&(0,A.jsxs)("div",{style:{textAlign:"center",padding:"50px"},children:[(0,A.jsx)(w.A,{size:"large"}),(0,A.jsx)("p",{style:{marginTop:"20px"},children:"\u6b63\u5728\u52a0\u8f7d\u6570\u636e..."})]}),!r&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(k.A,{style:{marginBottom:24},role:"region",children:(0,A.jsxs)(o.A,{children:[(0,A.jsx)("span",{children:"\u65f6\u95f4\u8303\u56f4\uff1a"}),(0,A.jsxs)(b.Ay.Group,{value:s,onChange:e=>{return t=e.target.value,a(t),void c([]);var t},children:[(0,A.jsx)(b.Ay.Button,{value:"all",children:"\u5168\u90e8\u6570\u636e"}),(0,A.jsx)(b.Ay.Button,{value:"today",children:"\u4eca\u5929"}),(0,A.jsx)(b.Ay.Button,{value:"week",children:"\u672c\u5468"}),(0,A.jsx)(b.Ay.Button,{value:"month",children:"\u672c\u6708"}),(0,A.jsx)(b.Ay.Button,{value:"year",children:"\u672c\u5e74"})]}),(0,A.jsx)(E,{onChange:e=>{e&&(c(e),a("custom"))},placeholder:["\u5f00\u59cb\u65e5\u671f","\u7ed3\u675f\u65e5\u671f"]})]})}),(0,A.jsxs)(Y.A,{gutter:[16,16],children:[(0,A.jsx)(I.A,{xs:24,sm:12,lg:6,children:(0,A.jsx)(k.A,{role:"region",children:(0,A.jsx)(C.A,{title:"\u603b\u8ba2\u5355\u6570",value:(null===t||void 0===t?void 0:t.total_orders)||0,prefix:(0,A.jsx)(p.A,{}),valueStyle:{color:"#3f8600"}})})}),(0,A.jsx)(I.A,{xs:24,sm:12,lg:6,children:(0,A.jsx)(k.A,{role:"region",children:(0,A.jsx)(C.A,{title:"\u5f85\u4ed8\u6b3e\u786e\u8ba4\u8ba2\u5355",value:(null===t||void 0===t?void 0:t.pending_payment_orders)||0,prefix:(0,A.jsx)(z.A,{}),valueStyle:{color:"#faad14"}})})}),(0,A.jsx)(I.A,{xs:24,sm:12,lg:6,children:(0,A.jsx)(k.A,{role:"region",children:(0,A.jsx)(C.A,{title:"\u5f85\u914d\u7f6e\u786e\u8ba4\u8ba2\u5355",value:(null===t||void 0===t?void 0:t.pending_config_orders)||0,prefix:(0,A.jsx)(z.A,{}),valueStyle:{color:"#fa8c16"}})})}),(0,A.jsx)(I.A,{xs:24,sm:12,lg:6,children:(0,A.jsx)(k.A,{role:"region",children:(0,A.jsx)(C.A,{title:"\u5df2\u4ed8\u6b3e\u786e\u8ba4\u8ba2\u5355",value:(null===t||void 0===t?void 0:t.confirmed_payment_orders)||0,prefix:(0,A.jsx)(M.A,{}),valueStyle:{color:"#52c41a"}})})})]}),(0,A.jsxs)(Y.A,{gutter:[16,16],style:{marginTop:16},children:[(0,A.jsx)(I.A,{xs:24,sm:12,lg:6,children:(0,A.jsx)(k.A,{role:"region",children:(0,A.jsx)(C.A,{title:"\u5df2\u914d\u7f6e\u786e\u8ba4\u8ba2\u5355",value:(null===t||void 0===t?void 0:t.confirmed_config_orders)||0,prefix:(0,A.jsx)(M.A,{}),valueStyle:{color:"#1890ff"}})})}),(0,A.jsx)(I.A,{xs:24,sm:12,lg:6,children:(0,A.jsx)(k.A,{role:"region",children:(0,A.jsx)(C.A,{title:"\u603b\u6536\u5165",value:(null===t||void 0===t?void 0:t.total_amount)||0,prefix:(0,A.jsx)($.A,{}),valueStyle:{color:"#1890ff"},suffix:"\u7f8e\u5143"})})}),(0,A.jsx)(I.A,{xs:24,sm:12,lg:6,children:(0,A.jsx)(k.A,{role:"region",children:(0,A.jsx)(C.A,{title:"\u9500\u552e\u8fd4\u4f63\u91d1\u989d",value:(null===t||void 0===t?void 0:t.commission_amount)||0,prefix:(0,A.jsx)($.A,{}),valueStyle:{color:"#722ed1"},suffix:"\u7f8e\u5143"})})}),(0,A.jsx)(I.A,{xs:24,sm:12,lg:6,children:(0,A.jsx)(k.A,{role:"region",children:(0,A.jsx)(C.A,{title:"\u5f85\u8fd4\u4f63\u91d1\u91d1\u989d",value:(null===t||void 0===t?void 0:t.pending_commission_amount)||0,prefix:(0,A.jsx)($.A,{}),valueStyle:{color:"#ff4d4f"},suffix:"\u7f8e\u5143"})})})]}),(0,A.jsx)(S.A,{orientation:"left",children:"\u9500\u552e\u5c42\u7ea7\u7edf\u8ba1"}),(0,A.jsxs)(Y.A,{gutter:[16,16],children:[(0,A.jsx)(I.A,{xs:24,sm:12,lg:6,children:(0,A.jsx)(k.A,{role:"region",children:(0,A.jsx)(C.A,{title:"\u4e00\u7ea7\u9500\u552e\u603b\u6570",value:(null===t||void 0===t?void 0:t.primary_sales_count)||0,prefix:(0,A.jsx)(F.A,{}),valueStyle:{color:"#f5222d"}})})}),(0,A.jsx)(I.A,{xs:24,sm:12,lg:6,children:(0,A.jsx)(k.A,{role:"region",children:(0,A.jsx)(C.A,{title:"\u4e8c\u7ea7\u9500\u552e\u603b\u6570",value:(null===t||void 0===t?void 0:t.secondary_sales_count)||0,prefix:(0,A.jsx)(R.A,{}),valueStyle:{color:"#52c41a"}})})}),(0,A.jsx)(I.A,{xs:24,sm:12,lg:6,children:(0,A.jsx)(k.A,{role:"region",children:(0,A.jsx)(C.A,{title:"\u4e00\u7ea7\u9500\u552e\u4e1a\u7ee9",value:(null===t||void 0===t?void 0:t.primary_sales_amount)||0,prefix:(0,A.jsx)($.A,{}),valueStyle:{color:"#fa8c16"},suffix:"\u7f8e\u5143"})})}),(0,A.jsx)(I.A,{xs:24,sm:12,lg:6,children:(0,A.jsx)(k.A,{role:"region",children:(0,A.jsx)(C.A,{title:"\u4e8c\u7ea7\u9500\u552e\u4e1a\u7ee9",value:(null===t||void 0===t?void 0:t.secondary_sales_amount)||0,prefix:(0,A.jsx)($.A,{}),valueStyle:{color:"#13c2c2"},suffix:"\u7f8e\u5143"})})})]}),(0,A.jsx)(S.A,{orientation:"left",children:"\u5c42\u7ea7\u5173\u7cfb\u7edf\u8ba1"}),(0,A.jsxs)(Y.A,{gutter:[16,16],children:[(0,A.jsx)(I.A,{xs:24,sm:12,lg:8,children:(0,A.jsx)(k.A,{role:"region",children:(0,A.jsx)(C.A,{title:"\u5e73\u5747\u4e8c\u7ea7\u9500\u552e\u6570",value:(null===t||void 0===t?void 0:t.avg_secondary_per_primary)||0,prefix:(0,A.jsx)(R.A,{}),valueStyle:{color:"#eb2f96"},precision:1})})}),(0,A.jsx)(I.A,{xs:24,sm:12,lg:8,children:(0,A.jsx)(k.A,{role:"region",children:(0,A.jsx)(C.A,{title:"\u6700\u9ad8\u4e8c\u7ea7\u9500\u552e\u6570",value:(null===t||void 0===t?void 0:t.max_secondary_per_primary)||0,prefix:(0,A.jsx)(R.A,{}),valueStyle:{color:"#722ed1"}})})})]}),(0,A.jsx)(k.A,{title:"\u8ba2\u5355\u5206\u7c7b\u7edf\u8ba1",style:{marginTop:24},role:"region",children:(0,A.jsxs)(Y.A,{gutter:[16,16],children:[(0,A.jsx)(I.A,{xs:24,sm:12,lg:6,children:(0,A.jsxs)("div",{children:[(0,A.jsx)("p",{children:"1\u4e2a\u6708\u8ba2\u5355"}),(0,A.jsx)(D.A,{percent:(null===t||void 0===t?void 0:t.one_month_percentage)||0,status:"active",strokeColor:"#108ee9"}),(0,A.jsxs)("p",{children:[(null===t||void 0===t?void 0:t.one_month_orders)||0,"\u7b14\uff0c\u5360\u6bd4",(Number(null===t||void 0===t?void 0:t.one_month_percentage)||0).toFixed(1),"%"]})]})}),(0,A.jsx)(I.A,{xs:24,sm:12,lg:6,children:(0,A.jsxs)("div",{children:[(0,A.jsx)("p",{children:"3\u4e2a\u6708\u8ba2\u5355"}),(0,A.jsx)(D.A,{percent:(null===t||void 0===t?void 0:t.three_month_percentage)||0,status:"active",strokeColor:"#87d068"}),(0,A.jsxs)("p",{children:[(null===t||void 0===t?void 0:t.three_month_orders)||0,"\u7b14\uff0c\u5360\u6bd4",(Number(null===t||void 0===t?void 0:t.three_month_percentage)||0).toFixed(1),"%"]})]})}),(0,A.jsx)(I.A,{xs:24,sm:12,lg:6,children:(0,A.jsxs)("div",{children:[(0,A.jsx)("p",{children:"6\u4e2a\u6708\u8ba2\u5355"}),(0,A.jsx)(D.A,{percent:(null===t||void 0===t?void 0:t.six_month_percentage)||0,status:"active",strokeColor:"#fa8c16"}),(0,A.jsxs)("p",{children:[(null===t||void 0===t?void 0:t.six_month_orders)||0,"\u7b14\uff0c\u5360\u6bd4",(Number(null===t||void 0===t?void 0:t.six_month_percentage)||0).toFixed(1),"%"]})]})}),(0,A.jsx)(I.A,{xs:24,sm:12,lg:6,children:(0,A.jsxs)("div",{children:[(0,A.jsx)("p",{children:"\u7ec8\u8eab\u8ba2\u5355"}),(0,A.jsx)(D.A,{percent:(null===t||void 0===t?void 0:t.lifetime_percentage)||0,status:"active",strokeColor:"#722ed1"}),(0,A.jsxs)("p",{children:[(null===t||void 0===t?void 0:t.lifetime_orders)||0,"\u7b14\uff0c\u5360\u6bd4",(Number(null===t||void 0===t?void 0:t.lifetime_percentage)||0).toFixed(1),"%"]})]})})]})})]})]})};var q=r(6553),L=r(3427),U=r(2019),O=r(6399),P=r(6651),V=r(5444),G=r(1381),N=r(6909),K=r(5008),J=r(6191),W=r(3390),Q=r(3727),Z=r(2058),X=r(5885),ee=r(446),te=r.n(ee);const{Title:re}=v.A,{Option:ne}=q.A,{RangePicker:ie}=f.A,le=()=>{const e=(0,i.wA)(),{orders:t,pagination:r,loading:l}=(0,i.d4)(e=>e.admin),[s]=L.A.useForm(),[a]=L.A.useForm(),[c,x]=(0,n.useState)(null),[h,m]=(0,n.useState)(!1),[u,j]=(0,n.useState)(""),p=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=a.getFieldsValue(),i={page:(null===r||void 0===r?void 0:r.page)||1,limit:(null===r||void 0===r?void 0:r.limit)||20,...n,...t};n.date_range&&2===n.date_range.length&&(i.start_date=n.date_range[0].format("YYYY-MM-DD"),i.end_date=n.date_range[1].format("YYYY-MM-DD"),delete i.date_range),n.payment_date_range&&2===n.payment_date_range.length&&(i.payment_start_date=n.payment_date_range[0].format("YYYY-MM-DD"),i.payment_end_date=n.payment_date_range[1].format("YYYY-MM-DD"),delete i.payment_date_range),n.config_date_range&&2===n.config_date_range.length&&(i.config_start_date=n.config_date_range[0].format("YYYY-MM-DD"),i.config_end_date=n.config_date_range[1].format("YYYY-MM-DD"),delete i.config_date_range),n.expiry_date_range&&2===n.expiry_date_range.length&&(i.expiry_start_date=n.expiry_date_range[0].format("YYYY-MM-DD"),i.expiry_end_date=n.expiry_date_range[1].format("YYYY-MM-DD"),delete i.expiry_date_range),e((0,T.vi)(i))};(0,n.useEffect)(()=>{p()},[]);const y=async(t,r)=>{try{await e((0,T.ro)({orderId:t,status:r})).unwrap(),U.Ay.success("\u72b6\u6001\u66f4\u65b0\u6210\u529f"),setTimeout(()=>{p()},500)}catch(n){U.Ay.error("\u72b6\u6001\u66f4\u65b0\u5931\u8d25")}},g=[{title:"\u8ba2\u5355ID",dataIndex:"id",key:"id",width:80,fixed:"left"},{title:"\u9500\u552e\u5fae\u4fe1\u53f7",key:"sales_wechat_name",width:120,render:(e,t)=>{const r=["sales_wechat_name","wechat_name","primary_sales_wechat","secondary_sales_wechat"];for(const n of r)if(t[n])return t[n];return"-"}},{title:"TradingView\u7528\u6237",dataIndex:"tradingview_username",key:"tradingview_username",width:150},{title:"\u8d2d\u4e70\u65f6\u957f",dataIndex:"duration",key:"duration",width:100,render:e=>({"7days":"7\u5929\u514d\u8d39","1month":"1\u4e2a\u6708","3months":"3\u4e2a\u6708","6months":"6\u4e2a\u6708",lifetime:"\u7ec8\u8eab"}[e]||e)},{title:"\u8d2d\u4e70\u65b9\u5f0f",dataIndex:"purchase_type",key:"purchase_type",width:100,render:e=>({immediate:"\u5373\u65f6\u8d2d\u4e70",advance:"\u63d0\u524d\u8d2d\u4e70"}[e]||e)},{title:"\u751f\u6548\u65f6\u95f4",dataIndex:"effective_time",key:"effective_time",width:150,render:e=>e?te()(e).format("YYYY-MM-DD HH:mm"):"-"},{title:"\u5230\u671f\u65f6\u95f4",dataIndex:"expiry_time",key:"expiry_time",width:150,render:e=>e?te()(e).format("YYYY-MM-DD HH:mm"):"-"},{title:"\u5e94\u4ed8\u91d1\u989d",dataIndex:"amount",key:"amount",width:100,render:e=>`$${e}`},{title:"\u5b9e\u4ed8\u91d1\u989d",dataIndex:"alipay_amount",key:"alipay_amount",width:120,render:(e,t)=>"alipay"===t.payment_method&&e?`\xa5${e}`:"crypto"===t.payment_method&&t.crypto_amount?`$${t.crypto_amount}`:`$${t.amount}`},{title:"\u4f63\u91d1",dataIndex:"commission_amount",key:"commission_amount",width:100,render:e=>`\xa5${e||0}`},{title:"\u4ed8\u6b3e\u65b9\u5f0f",dataIndex:"payment_method",key:"payment_method",width:100,render:e=>({alipay:"\u652f\u4ed8\u5b9d",crypto:"\u7ebf\u4e0a\u5730\u5740\u7801"}[e]||e)},{title:"\u8ba2\u5355\u72b6\u6001",dataIndex:"status",key:"status",width:120,render:e=>{const t={pending_payment:{text:"\u5f85\u4ed8\u6b3e\u786e\u8ba4",color:"orange"},pending_review:{text:"\u5f85\u4ed8\u6b3e\u786e\u8ba4",color:"orange"},confirmed_payment:{text:"\u5df2\u4ed8\u6b3e\u786e\u8ba4",color:"blue"},pending_config:{text:"\u5f85\u914d\u7f6e\u786e\u8ba4",color:"purple"},confirmed_configuration:{text:"\u5df2\u914d\u7f6e\u786e\u8ba4",color:"green"},active:{text:"\u5df2\u751f\u6548",color:"green"},expired:{text:"\u5df2\u8fc7\u671f",color:"gray"},cancelled:{text:"\u5df2\u53d6\u6d88",color:"red"},rejected:{text:"\u5df2\u62d2\u7edd",color:"red"}}[e]||{text:e,color:"default"};return(0,A.jsx)(O.A,{color:t.color,children:t.text})}},{title:"\u4ed8\u6b3e\u622a\u56fe",dataIndex:"screenshot_path",key:"screenshot_path",width:120,render:e=>e?(0,A.jsx)(P.A,{title:"\u67e5\u770b\u622a\u56fe",children:(0,A.jsx)(d.Ay,{type:"link",icon:(0,A.jsx)(J.A,{}),onClick:()=>(j(e),void m(!0)),size:"small"})}):"-"},{title:"\u8d2d\u4e70\u7c7b\u578b",dataIndex:"purchase_type",key:"purchase_type",width:100,render:e=>({immediate:"\u5373\u65f6\u8d2d\u4e70",advance:"\u63d0\u524d\u8d2d\u4e70"}[e]||e)},{title:"\u914d\u7f6e\u786e\u8ba4\u65f6\u95f4",dataIndex:"effective_time",key:"effective_time",width:150,render:e=>e?te()(e).format("YYYY-MM-DD HH:mm"):"-"},{title:"\u64cd\u4f5c",key:"action",width:200,render:(e,t)=>(0,A.jsx)(o.A,{size:"small",wrap:!0,children:(()=>{switch("pending_review"===t.status?"pending_payment":t.status){case"pending_payment":return"7days"===t.duration?(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(d.Ay,{type:"primary",size:"small",icon:(0,A.jsx)(W.A,{}),onClick:()=>y(t.id,"pending_config"),children:"\u8fdb\u5165\u914d\u7f6e\u786e\u8ba4"}),(0,A.jsx)(d.Ay,{type:"link",size:"small",danger:!0,icon:(0,A.jsx)(Q.A,{}),onClick:()=>y(t.id,"rejected"),children:"\u62d2\u7edd\u8ba2\u5355"})]}):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(d.Ay,{type:"primary",size:"small",icon:(0,A.jsx)(W.A,{}),onClick:()=>y(t.id,"confirmed_payment"),children:"\u786e\u8ba4\u4ed8\u6b3e"}),(0,A.jsx)(d.Ay,{type:"link",size:"small",danger:!0,icon:(0,A.jsx)(Q.A,{}),onClick:()=>y(t.id,"rejected"),children:"\u62d2\u7edd\u8ba2\u5355"})]});case"confirmed_payment":return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(d.Ay,{type:"primary",size:"small",icon:(0,A.jsx)(W.A,{}),onClick:()=>y(t.id,"pending_config"),children:"\u8fdb\u5165\u914d\u7f6e\u786e\u8ba4"}),(0,A.jsx)(d.Ay,{type:"link",size:"small",danger:!0,icon:(0,A.jsx)(Q.A,{}),onClick:()=>y(t.id,"rejected"),children:"\u62d2\u7edd\u8ba2\u5355"})]});case"pending_config":return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(d.Ay,{type:"primary",size:"small",icon:(0,A.jsx)(W.A,{}),onClick:()=>y(t.id,"confirmed_configuration"),children:"\u786e\u8ba4\u914d\u7f6e\u5b8c\u6210"}),(0,A.jsx)(d.Ay,{type:"link",size:"small",danger:!0,icon:(0,A.jsx)(Q.A,{}),onClick:()=>y(t.id,"rejected"),children:"\u62d2\u7edd\u8ba2\u5355"})]});case"confirmed_configuration":return(0,A.jsx)("span",{style:{color:"#52c41a",fontSize:"12px"},children:"\u2713 \u5df2\u5b8c\u6210"});case"active":return(0,A.jsx)("span",{style:{color:"#52c41a",fontSize:"12px"},children:"\u2713 \u5df2\u751f\u6548"});case"expired":return(0,A.jsx)("span",{style:{color:"#ff4d4f",fontSize:"12px"},children:"\u2717 \u5df2\u8fc7\u671f"});case"cancelled":return(0,A.jsx)("span",{style:{color:"#ff4d4f",fontSize:"12px"},children:"\u2717 \u5df2\u53d6\u6d88"});case"rejected":return(0,A.jsx)("span",{style:{color:"#ff4d4f",fontSize:"12px"},children:"\u2717 \u5df2\u62d2\u7edd"});default:return(0,A.jsx)(d.Ay,{type:"link",size:"small",danger:!0,icon:(0,A.jsx)(Q.A,{}),onClick:()=>y(t.id,"rejected"),children:"\u62d2\u7edd\u8ba2\u5355"})}})()})}];return(0,A.jsxs)("div",{children:[(0,A.jsx)(re,{level:2,children:"\u8ba2\u5355\u7ba1\u7406"}),(0,A.jsx)(k.A,{style:{marginBottom:16},children:(0,A.jsx)(L.A,{form:a,layout:"inline",children:(0,A.jsxs)(Y.A,{gutter:[16,16],style:{width:"100%"},children:[(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"sales_wechat",label:"\u9500\u552e\u5fae\u4fe1\u53f7",children:(0,A.jsx)(V.A,{placeholder:"\u8bf7\u8f93\u5165\u9500\u552e\u5fae\u4fe1\u53f7"})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"tradingview_username",label:"TradingView\u7528\u6237",children:(0,A.jsx)(V.A,{placeholder:"\u8bf7\u8f93\u5165TradingView\u7528\u6237"})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"purchase_type",label:"\u8d2d\u4e70\u65b9\u5f0f",children:(0,A.jsxs)(q.A,{placeholder:"\u8bf7\u9009\u62e9\u8d2d\u4e70\u65b9\u5f0f",allowClear:!0,children:[(0,A.jsx)(ne,{value:"immediate",children:"\u5373\u65f6\u8d2d\u4e70"}),(0,A.jsx)(ne,{value:"advance",children:"\u63d0\u524d\u8d2d\u4e70"})]})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"payment_method",label:"\u4ed8\u6b3e\u65b9\u5f0f",children:(0,A.jsxs)(q.A,{placeholder:"\u8bf7\u9009\u62e9\u4ed8\u6b3e\u65b9\u5f0f",allowClear:!0,children:[(0,A.jsx)(ne,{value:"alipay",children:"\u652f\u4ed8\u5b9d"}),(0,A.jsx)(ne,{value:"crypto",children:"\u7ebf\u4e0a\u5730\u5740\u7801"})]})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"status",label:"\u8ba2\u5355\u72b6\u6001",children:(0,A.jsxs)(q.A,{placeholder:"\u8bf7\u9009\u62e9\u72b6\u6001",allowClear:!0,children:[(0,A.jsx)(ne,{value:"pending_payment",children:"\u5f85\u4ed8\u6b3e\u786e\u8ba4"}),(0,A.jsx)(ne,{value:"confirmed_payment",children:"\u5df2\u4ed8\u6b3e\u786e\u8ba4"}),(0,A.jsx)(ne,{value:"pending_config",children:"\u5f85\u914d\u7f6e\u786e\u8ba4"}),(0,A.jsx)(ne,{value:"confirmed_configuration",children:"\u5df2\u914d\u7f6e\u786e\u8ba4"}),(0,A.jsx)(ne,{value:"active",children:"\u5df2\u751f\u6548"}),(0,A.jsx)(ne,{value:"expired",children:"\u5df2\u8fc7\u671f"}),(0,A.jsx)(ne,{value:"cancelled",children:"\u5df2\u53d6\u6d88"}),(0,A.jsx)(ne,{value:"rejected",children:"\u5df2\u62d2\u7edd"})]})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"date_range",label:"\u63d0\u4ea4\u65f6\u95f4",children:(0,A.jsx)(ie,{style:{width:"100%"}})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"payment_date_range",label:"\u4ed8\u6b3e\u65f6\u95f4",children:(0,A.jsx)(ie,{style:{width:"100%"}})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"config_date_range",label:"\u914d\u7f6e\u65f6\u95f4",children:(0,A.jsx)(ie,{style:{width:"100%"}})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"expiry_date_range",label:"\u5230\u671f\u65f6\u95f4",children:(0,A.jsx)(ie,{style:{width:"100%"}})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"amount_range",label:"\u4ed8\u6b3e\u91d1\u989d",children:(0,A.jsxs)(V.A.Group,{compact:!0,children:[(0,A.jsx)(V.A,{style:{width:"40%",textAlign:"center"},placeholder:"\u6700\u5c0f\u91d1\u989d",name:"min_amount",type:"number"}),(0,A.jsx)(V.A,{style:{width:"20%",textAlign:"center",borderLeft:0,borderRight:0,pointerEvents:"none"},placeholder:"~",disabled:!0}),(0,A.jsx)(V.A,{style:{width:"40%",textAlign:"center",borderLeft:0},placeholder:"\u6700\u5927\u91d1\u989d",name:"max_amount",type:"number"})]})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsxs)(o.A,{children:[(0,A.jsx)(d.Ay,{type:"primary",icon:(0,A.jsx)(Z.A,{}),onClick:()=>{p({page:1})},children:"\u641c\u7d22"}),(0,A.jsx)(d.Ay,{onClick:()=>{a.resetFields(),p({page:1})},children:"\u91cd\u7f6e"}),(0,A.jsx)(d.Ay,{icon:(0,A.jsx)(X.A,{}),onClick:async()=>{try{const t=a.getFieldsValue(),r={...t};t.date_range&&2===t.date_range.length&&(r.start_date=t.date_range[0].format("YYYY-MM-DD"),r.end_date=t.date_range[1].format("YYYY-MM-DD"),delete r.date_range),t.payment_date_range&&2===t.payment_date_range.length&&(r.payment_start_date=t.payment_date_range[0].format("YYYY-MM-DD"),r.payment_end_date=t.payment_date_range[1].format("YYYY-MM-DD"),delete r.payment_date_range);const n=await e((0,T.Kd)(r)).unwrap(),i=new Blob([n],{type:"text/csv"}),l=window.URL.createObjectURL(i),s=document.createElement("a");s.href=l,s.download=`orders_${te()().format("YYYY-MM-DD_HH-mm-ss")}.csv`,s.click(),window.URL.revokeObjectURL(l),U.Ay.success("\u5bfc\u51fa\u6210\u529f")}catch(t){U.Ay.error("\u5bfc\u51fa\u5931\u8d25")}},children:"\u5bfc\u51fa"})]})})]})})}),(0,A.jsx)(k.A,{children:(0,A.jsx)(G.A,{columns:g,dataSource:t,rowKey:"id",scroll:{x:1500},pagination:{current:(null===r||void 0===r?void 0:r.page)||1,pageSize:(null===r||void 0===r?void 0:r.limit)||20,total:(null===r||void 0===r?void 0:r.total)||0,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`\u7b2c ${t[0]}-${t[1]} \u6761/\u5171 ${e} \u6761`},loading:l,onChange:e=>{p({page:e.current,limit:e.pageSize})}})}),(0,A.jsx)(N.A,{open:h,title:"\u4ed8\u6b3e\u622a\u56fe",footer:null,onCancel:()=>m(!1),width:"80%",style:{top:20},destroyOnClose:!0,children:(0,A.jsx)(K.A,{alt:"\u4ed8\u6b3e\u622a\u56fe",style:{width:"100%"},src:u})})]})};var se=r(1118),ae=r(7407),de=r(9025);const{Title:oe}=v.A,{Option:ce}=q.A,{RangePicker:xe}=f.A,he=()=>{const e=(0,i.wA)(),{sales:t,loading:r}=(0,i.d4)(e=>e.admin),[l]=L.A.useForm(),[s,a]=(0,n.useState)({}),[c,x]=(0,n.useState)({}),[h,m]=(0,n.useState)("all"),[u,j]=(0,n.useState)([]);(0,n.useEffect)(()=>{e((0,T.$7)())},[e]),(0,n.useEffect)(()=>{if(t&&t.length>0){const e=new Set;t.forEach(t=>{var r;if(null!==(r=t.sales)&&void 0!==r&&r.commission_rate&&e.add(t.sales.commission_rate),"primary"===t.sales_type){const r=p(t);r&&r>0&&e.add(Math.round(r))}});const r=Array.from(e).filter(e=>e&&e>0).sort((e,t)=>e-t).map(e=>({value:e,label:`${e}%`}));j(r)}},[t]);(0,n.useEffect)(()=>{(async()=>{})()},[]);const p=e=>{if(!e.orders||0===e.orders.length)return 40;const t=e.orders;if(0===t.length)return 40;const r=t.filter(e=>!e.secondary_sales_name).reduce((e,t)=>e+(t.amount||0),0),n=t.filter(e=>e.secondary_sales_name).reduce((e,t)=>e+(t.amount||0),0);let i=0;if(e.secondary_sales&&e.secondary_sales.length>0){const t=e.secondary_sales.map(e=>e.commission_rate||.3);i=t.reduce((e,t)=>e+t,0)/t.length}const l=r+n;if(0===l)return 40;return parseFloat(((.4*r+n*((40-100*i)/100))/l*100).toFixed(1))},y=(e,t)=>{if(!e||0===e.length)return 0;return e.filter(e=>"confirmed_configuration"===e.status).reduce((e,t)=>e+(t.amount||0),0)*t/100},g=e=>{var t,r;const n=null===(t=e.sales)||void 0===t?void 0:t.id;return s[n]||(null===(r=e.sales)||void 0===r?void 0:r.commission_rate)||0},_=(e,t)=>{a(r=>({...r,[e]:t}))},v=e=>"primary"===e.sales_type?`\u7ba1\u7406 ${e.secondary_sales_count||0} \u4e2a\u4e8c\u7ea7\u9500\u552e`:"secondary"===e.sales_type?`\u96b6\u5c5e\u4e8e: ${e.primary_sales_name||"\u672a\u77e5"}`:"",f=[{title:"\u9500\u552eID",dataIndex:["sales","id"],key:"sales_id",width:80},{title:"\u9500\u552e\u7c7b\u578b",key:"sales_type",width:120,render:(e,t)=>{var r,n;return"primary"===(n=(null===(r=t.sales)||void 0===r?void 0:r.sales_type)||"secondary")?(0,A.jsx)(O.A,{color:"red",icon:(0,A.jsx)(F.A,{}),children:"\u4e00\u7ea7\u9500\u552e"}):"secondary"===n?(0,A.jsx)(O.A,{color:"green",icon:(0,A.jsx)(R.A,{}),children:"\u4e8c\u7ea7\u9500\u552e"}):(0,A.jsx)(O.A,{color:"default",children:"\u672a\u77e5"})}},{title:"\u9500\u552e\u5fae\u4fe1\u53f7",dataIndex:["sales","wechat_name"],key:"wechat_name",width:120},{title:"\u5c42\u7ea7\u5173\u7cfb",key:"hierarchy",width:150,render:(e,t)=>(0,A.jsx)(P.A,{title:v(t),children:(0,A.jsx)("span",{style:{color:"#666",fontSize:"12px"},children:v(t)})})},{title:"\u603b\u8ba2\u5355\u6570",dataIndex:"total_orders",key:"total_orders",width:100},{title:"\u6709\u6548\u8ba2\u5355\u6570",dataIndex:"valid_orders",key:"valid_orders",width:100,render:(e,t)=>{var r;return((null===(r=t.orders)||void 0===r?void 0:r.filter(e=>"confirmed_configuration"===e.status))||[]).length}},{title:"\u603b\u91d1\u989d",dataIndex:"total_amount",key:"total_amount",width:100,render:(e,t)=>`$${(t.orders||[]).reduce((e,t)=>e+(t.amount||0),0).toFixed(2)}`},{title:"\u4f63\u91d1\u7387",key:"commission_rate",width:120,render:(t,r)=>{var n,i,l;const c=null===(n=r.sales)||void 0===n?void 0:n.id;let x;x="primary"===(null===(i=r.sales)||void 0===i?void 0:i.sales_type)?p(r):(e=>{if(!e||0===e.length)return 0;const t=e.reduce((e,t)=>e+(t.amount||0),0);return 0===e.filter(e=>"confirmed_configuration"===e.status).length?0:t>=1e3?15:t>=500?12:t>=200?10:8})(r.orders);const h=s[c]||(null===(l=r.sales)||void 0===l?void 0:l.commission_rate)||x,m=g(r);return void 0!==s[c]?(0,A.jsxs)(o.A,{size:"small",children:[(0,A.jsx)(se.A,{size:"small",min:0,max:100,value:h,onChange:e=>_(c,e),style:{width:60}}),(0,A.jsx)(d.Ay,{type:"primary",size:"small",icon:(0,A.jsx)(W.A,{}),onClick:()=>(async t=>{try{const r=s[t];await e((0,T.N5)({salesId:t,commissionRate:r})).unwrap(),a(e=>{const r={...e};return delete r[t],r}),U.Ay.success("\u4f63\u91d1\u7387\u66f4\u65b0\u6210\u529f")}catch(r){U.Ay.error("\u4f63\u91d1\u7387\u66f4\u65b0\u5931\u8d25")}})(c)}),(0,A.jsx)(d.Ay,{size:"small",icon:(0,A.jsx)(Q.A,{}),onClick:()=>(e=>{a(t=>{const r={...t};return delete r[e],r})})(c)})]}):(0,A.jsxs)(o.A,{size:"small",children:[(0,A.jsxs)(O.A,{color:m===x?"blue":"green",children:[h,"%"]}),(0,A.jsx)(d.Ay,{type:"link",icon:(0,A.jsx)(ae.A,{}),onClick:()=>_(c,m)})]})}},{title:"\u5df2\u914d\u7f6e\u786e\u8ba4\u8ba2\u5355\u91d1\u989d",key:"confirmed_config_amount",width:140,render:(e,t)=>{var r;return`$${((null===(r=t.orders)||void 0===r?void 0:r.filter(e=>"confirmed_configuration"===e.status))||[]).reduce((e,t)=>e+(t.amount||0),0).toFixed(2)}`}},{title:"\u5e94\u8fd4\u4f63\u91d1\u989d",key:"commission_amount",width:120,render:(e,t)=>{var r;const n=null===(r=t.sales)||void 0===r?void 0:r.id,i=g(t),l=s[n]||i;return`$${y(t.orders,l).toFixed(2)}`}},{title:"\u5df2\u8fd4\u4f63\u91d1\u989d",key:"paid_commission",width:150,render:(e,t)=>{var r;const n=null===(r=t.sales)||void 0===r?void 0:r.id,i=c[n]||0;return(0,A.jsxs)(o.A,{size:"small",children:[(0,A.jsx)(se.A,{size:"small",min:0,step:.01,value:i,formatter:e=>`$${e}`,parser:e=>e.replace("$",""),style:{width:80},placeholder:"\u5df2\u8fd4\u4f63",onChange:e=>((e,t)=>{x(r=>({...r,[e]:t||0}))})(n,e)}),(0,A.jsx)(d.Ay,{type:"primary",size:"small",icon:(0,A.jsx)(W.A,{}),onClick:()=>{U.Ay.success("\u5df2\u8fd4\u4f63\u91d1\u989d\u5df2\u786e\u8ba4")},children:"\u786e\u8ba4"})]})}},{title:"\u5f85\u8fd4\u4f63\u72b6\u6001",key:"pending_commission_status",width:100,render:(e,t)=>{var r;const n=null===(r=t.sales)||void 0===r?void 0:r.id,i=g(t),l=s[n]||i,a=y(t.orders,l)-(c[n]||0);return a>0?(0,A.jsx)(O.A,{color:"orange",children:"\u5f85\u8fd4\u4f63"}):a<0?(0,A.jsx)(O.A,{color:"red",children:"\u8d85\u989d"}):(0,A.jsx)(O.A,{color:"green",children:"\u5df2\u7ed3\u6e05"})}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"created_at",key:"created_at",width:150,render:e=>te()(e).format("YYYY-MM-DD HH:mm")},{title:"\u9500\u552e\u94fe\u63a5",key:"links",width:300,render:(e,t)=>(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[t.links&&t.links.map((e,t)=>(0,A.jsxs)("div",{style:{padding:8,border:"1px solid #e8e8e8",borderRadius:4,backgroundColor:"#fafafa"},children:[(0,A.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:4},children:[(0,A.jsx)(O.A,{color:"sales_register"===e.type?"orange":"blue",children:e.title}),(0,A.jsxs)(o.A,{size:"small",children:[(0,A.jsx)(P.A,{title:"\u590d\u5236\u94fe\u63a5",children:(0,A.jsx)(d.Ay,{type:"link",size:"small",icon:(0,A.jsx)(de.A,{}),onClick:()=>(async e=>{try{await navigator.clipboard.writeText(e),U.Ay.success("\u94fe\u63a5\u5df2\u590d\u5236\u5230\u526a\u8d34\u677f")}catch(t){U.Ay.error("\u590d\u5236\u5931\u8d25")}})(e.fullUrl)})}),(0,A.jsx)(P.A,{title:"\u590d\u5236\u4ee3\u7801",children:(0,A.jsx)(d.Ay,{type:"link",size:"small",icon:(0,A.jsx)(de.A,{}),onClick:()=>(async e=>{try{await navigator.clipboard.writeText(e),U.Ay.success("\u94fe\u63a5\u4ee3\u7801\u5df2\u590d\u5236\u5230\u526a\u8d34\u677f")}catch(t){U.Ay.error("\u590d\u5236\u5931\u8d25")}})(e.code)})})]})]}),(0,A.jsxs)("div",{style:{fontSize:12,color:"#666"},children:["\u4ee3\u7801: ",e.code]}),(0,A.jsx)("div",{style:{fontSize:11,color:"#999"},children:e.description})]},t)),(!t.links||0===t.links.length)&&(0,A.jsx)("span",{style:{color:"#ccc"},children:"\u6682\u65e0\u94fe\u63a5"})]})}];return(0,A.jsxs)("div",{children:[(0,A.jsx)(oe,{level:2,children:"\u9500\u552e\u7ba1\u7406"}),(0,A.jsx)(k.A,{style:{marginBottom:16},children:(0,A.jsx)(L.A,{form:l,layout:"inline",children:(0,A.jsxs)(Y.A,{gutter:[16,16],style:{width:"100%"},children:[(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"sales_type",label:"\u9500\u552e\u7c7b\u578b",children:(0,A.jsxs)(q.A,{placeholder:"\u9009\u62e9\u9500\u552e\u7c7b\u578b",allowClear:!0,value:h,onChange:e=>{m(e)},children:[(0,A.jsx)(ce,{value:"all",children:"\u5168\u90e8\u9500\u552e"}),(0,A.jsx)(ce,{value:"primary",children:"\u4e00\u7ea7\u9500\u552e"}),(0,A.jsx)(ce,{value:"secondary",children:"\u4e8c\u7ea7\u9500\u552e"})]})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"wechat_name",label:"\u9500\u552e\u5fae\u4fe1\u53f7",children:(0,A.jsx)(V.A,{placeholder:"\u8bf7\u8f93\u5165\u9500\u552e\u5fae\u4fe1\u53f7"})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"payment_method",label:"\u6536\u6b3e\u65b9\u5f0f",children:(0,A.jsxs)(q.A,{placeholder:"\u8bf7\u9009\u62e9\u6536\u6b3e\u65b9\u5f0f",allowClear:!0,children:[(0,A.jsx)(ce,{value:"alipay",children:"\u652f\u4ed8\u5b9d"}),(0,A.jsx)(ce,{value:"crypto",children:"\u7ebf\u4e0a\u5730\u5740\u7801"})]})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"create_date_range",label:"\u521b\u5efa\u65f6\u95f4",children:(0,A.jsx)(xe,{style:{width:"100%"}})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"commission_rate",label:"\u4f63\u91d1\u6bd4\u7387",children:(0,A.jsx)(q.A,{placeholder:"\u8bf7\u9009\u62e9\u4f63\u91d1\u6bd4\u7387",allowClear:!0,children:u.map(e=>(0,A.jsx)(ce,{value:e.value,children:e.label},e.value))})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"config_confirmed_filter",label:"\u914d\u7f6e\u786e\u8ba4\u72b6\u6001",children:(0,A.jsxs)(q.A,{placeholder:"\u9009\u62e9\u914d\u7f6e\u786e\u8ba4\u72b6\u6001",allowClear:!0,children:[(0,A.jsx)(ce,{value:"all",children:"\u5168\u90e8\u8ba2\u5355"}),(0,A.jsx)(ce,{value:"confirmed",children:"\u5df2\u914d\u7f6e\u786e\u8ba4"}),(0,A.jsx)(ce,{value:"pending",children:"\u5f85\u914d\u7f6e\u786e\u8ba4"})]})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsxs)(o.A,{children:[(0,A.jsx)(d.Ay,{type:"primary",onClick:()=>{l.getFieldsValue()},icon:(0,A.jsx)(Z.A,{}),children:"\u641c\u7d22"}),(0,A.jsx)(d.Ay,{onClick:()=>{l.resetFields(),e((0,T.$7)())},children:"\u91cd\u7f6e"})]})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(d.Ay,{type:"primary",onClick:()=>{const e=t.map(e=>{var t,r,n,i,l;return{"\u9500\u552eID":null===(t=e.sales)||void 0===t?void 0:t.id,"\u9500\u552e\u7c7b\u578b":"primary"===(null===(r=e.sales)||void 0===r?void 0:r.sales_type)?"\u4e00\u7ea7\u9500\u552e":"\u4e8c\u7ea7\u9500\u552e","\u5fae\u4fe1\u53f7":null===(n=e.sales)||void 0===n?void 0:n.wechat_name,"\u94fe\u63a5\u4ee3\u7801":e.link_code,"\u5c42\u7ea7\u5173\u7cfb":v(e),"\u603b\u8ba2\u5355\u6570":e.total_orders,"\u6709\u6548\u8ba2\u5355\u6570":e.valid_orders,"\u603b\u91d1\u989d":e.total_amount,"\u4f63\u91d1\u7387":`${(null===(i=e.sales)||void 0===i?void 0:i.commission_rate)||0}%`,"\u521b\u5efa\u65f6\u95f4":null===(l=e.sales)||void 0===l?void 0:l.created_at}}),r=Object.keys(e[0]||{}),n=[r.join(","),...e.map(e=>r.map(t=>`"${e[t]||""}"`).join(","))].join("\n"),i=new Blob(["\ufeff"+n],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),s=URL.createObjectURL(i);l.setAttribute("href",s),l.setAttribute("download",`\u9500\u552e\u6570\u636e_${(new Date).toISOString().split("T")[0]}.csv`),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l),U.Ay.success("\u9500\u552e\u6570\u636e\u5bfc\u51fa\u6210\u529f")},icon:(0,A.jsx)(X.A,{}),style:{float:"right"},children:"\u5bfc\u51fa\u6570\u636e"})})]})})}),(0,A.jsx)(k.A,{children:(0,A.jsx)(G.A,{columns:f,dataSource:t,rowKey:e=>{var t;return(null===(t=e.sales)||void 0===t?void 0:t.id)||e.id},pagination:{showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`\u7b2c ${t[0]}-${t[1]} \u6761/\u5171 ${e} \u6761`},loading:r,scroll:{x:1500}})})]})},{Title:me}=v.A,{Option:ue}=q.A,{RangePicker:je}=f.A,pe=()=>{const e=(0,i.wA)(),{customers:t,loading:r}=(0,i.d4)(e=>e.admin),[l]=L.A.useForm();(0,n.useEffect)(()=>{e((0,T.od)())},[e]);const s=[{title:"\u5ba2\u6237\u5fae\u4fe1\u53f7",dataIndex:"customer_wechat",key:"customer_wechat",width:120},{title:"TradingView\u7528\u6237",dataIndex:"tradingview_username",key:"tradingview_username",width:150},{title:"\u9500\u552e\u5fae\u4fe1\u53f7",dataIndex:"sales_wechat",key:"sales_wechat",width:120},{title:"\u603b\u8ba2\u5355\u6570",dataIndex:"total_orders",key:"total_orders",width:100},{title:"\u603b\u91d1\u989d",dataIndex:"total_amount",key:"total_amount",width:100,render:e=>`$${e}`},{title:"\u8fd4\u4f63\u91d1\u989d",dataIndex:"commission_amount",key:"commission_amount",width:100,render:e=>`$${parseFloat(e||0).toFixed(2)}`},{title:"\u5230\u671f\u65f6\u95f4",dataIndex:"expiry_date",key:"expiry_date",width:150,render:e=>te()(e).format("YYYY-MM-DD HH:mm")},{title:"\u50ac\u5355\u72b6\u6001",dataIndex:"is_reminded",key:"is_reminded",width:100,render:e=>{const t={false:{text:"\u672a\u50ac\u5355",color:"orange"},true:{text:"\u5df2\u50ac\u5355",color:"green"}}[e]||{text:e?"\u5df2\u50ac\u5355":"\u672a\u50ac\u5355",color:"default"};return(0,A.jsx)(O.A,{color:t.color,children:t.text})}}];return(0,A.jsxs)("div",{children:[(0,A.jsx)(me,{level:2,children:"\u5ba2\u6237\u7ba1\u7406"}),(0,A.jsx)(k.A,{style:{marginBottom:16},children:(0,A.jsx)(L.A,{form:l,layout:"inline",children:(0,A.jsxs)(Y.A,{gutter:[16,16],style:{width:"100%"},children:[(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"customer_wechat",label:"\u5ba2\u6237\u5fae\u4fe1",children:(0,A.jsx)(V.A,{placeholder:"\u8bf7\u8f93\u5165\u5ba2\u6237\u5fae\u4fe1"})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"sales_wechat",label:"\u9500\u552e\u5fae\u4fe1\u53f7",children:(0,A.jsx)(V.A,{placeholder:"\u8bf7\u8f93\u5165\u9500\u552e\u5fae\u4fe1\u53f7"})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"remind_status",label:"\u50ac\u5355\u72b6\u6001",children:(0,A.jsxs)(q.A,{placeholder:"\u8bf7\u9009\u62e9\u72b6\u6001",allowClear:!0,children:[(0,A.jsx)(ue,{value:"false",children:"\u672a\u50ac\u5355"}),(0,A.jsx)(ue,{value:"true",children:"\u5df2\u50ac\u5355"})]})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"date_range",label:"\u5230\u671f\u65f6\u95f4",children:(0,A.jsx)(je,{style:{width:"100%"}})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsx)(L.A.Item,{name:"config_confirmed_filter",label:"\u914d\u7f6e\u786e\u8ba4\u72b6\u6001",children:(0,A.jsxs)(q.A,{placeholder:"\u9009\u62e9\u914d\u7f6e\u786e\u8ba4\u72b6\u6001",allowClear:!0,children:[(0,A.jsx)(ue,{value:"all",children:"\u5168\u90e8\u8ba2\u5355"}),(0,A.jsx)(ue,{value:"confirmed",children:"\u5df2\u914d\u7f6e\u786e\u8ba4"}),(0,A.jsx)(ue,{value:"pending",children:"\u5f85\u914d\u7f6e\u786e\u8ba4"})]})})}),(0,A.jsx)(I.A,{xs:24,sm:12,md:6,children:(0,A.jsxs)(o.A,{children:[(0,A.jsx)(d.Ay,{type:"primary",icon:(0,A.jsx)(Z.A,{}),onClick:()=>{var t,r,n,i;const s=l.getFieldsValue();console.log("\u641c\u7d22\u6761\u4ef6:",s);const a={customer_wechat:s.customer_wechat,sales_wechat:s.sales_wechat,is_reminded:s.remind_status,start_date:null===(t=s.date_range)||void 0===t||null===(r=t[0])||void 0===r?void 0:r.format("YYYY-MM-DD"),end_date:null===(n=s.date_range)||void 0===n||null===(i=n[1])||void 0===i?void 0:i.format("YYYY-MM-DD")};Object.keys(a).forEach(e=>{a[e]||delete a[e]}),e((0,T.od)(a)),U.Ay.success("\u641c\u7d22\u5b8c\u6210")},children:"\u641c\u7d22"}),(0,A.jsx)(d.Ay,{onClick:()=>{l.resetFields(),e((0,T.od)())},children:"\u91cd\u7f6e"}),(0,A.jsx)(d.Ay,{icon:(0,A.jsx)(X.A,{}),onClick:()=>{if(!t||0===t.length)return void U.Ay.warning("\u6682\u65e0\u6570\u636e\u53ef\u5bfc\u51fa");const e=t.map(e=>({"\u5ba2\u6237\u5fae\u4fe1\u53f7":e.customer_wechat||"","TradingView\u7528\u6237\u540d":e.tradingview_username||"","\u9500\u552e\u5fae\u4fe1\u53f7":e.sales_wechat||"","\u8ba2\u5355\u91d1\u989d":e.amount?`$${e.amount}`:"","\u8ba2\u5355\u65f6\u957f":e.duration_text||e.duration||"","\u5230\u671f\u65f6\u95f4":e.expiry_time?new Date(e.expiry_time).toLocaleString("zh-CN"):"","\u50ac\u5355\u72b6\u6001":e.is_reminded?"\u5df2\u50ac\u5355":"\u672a\u50ac\u5355","\u8ba2\u5355\u72b6\u6001":e.status_text||e.status||"","\u521b\u5efa\u65f6\u95f4":e.created_at?new Date(e.created_at).toLocaleString("zh-CN"):""}));if(0===e.length)return void U.Ay.warning("\u6ca1\u6709\u6570\u636e\u53ef\u5bfc\u51fa");const r=Object.keys(e[0]),n=[r.join(","),...e.map(e=>r.map(t=>`"${e[t]||""}"`).join(","))].join("\n"),i=new Blob(["\ufeff"+n],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),s=URL.createObjectURL(i);l.setAttribute("href",s),l.setAttribute("download",`\u5ba2\u6237\u6570\u636e_${(new Date).toISOString().split("T")[0]}.csv`),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l),U.Ay.success("\u5ba2\u6237\u6570\u636e\u5bfc\u51fa\u6210\u529f")},children:"\u5bfc\u51fa\u6570\u636e"})]})})]})})}),(0,A.jsx)(k.A,{children:(0,A.jsx)(G.A,{columns:s,dataSource:Array.isArray(t)?t:[],rowKey:"id",pagination:{showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`\u7b2c ${t[0]}-${t[1]} \u6761/\u5171 ${e} \u6761`},loading:r,scroll:{x:1400}})})]})};var ye=r(7284),Ae=r(1966),ge=r(4733),_e=r(8143),ve=r(6732);const{Title:fe,Text:we}=v.A,ke=()=>{const e=(0,i.wA)(),{config:t,loading:r}=(0,i.d4)(e=>e.paymentConfig),[l]=L.A.useForm(),[s,a]=(0,n.useState)(""),[c,x]=(0,n.useState)("");(0,n.useEffect)(()=>{e((0,ve.jp)())},[e]),(0,n.useEffect)(()=>{t&&(l.setFieldsValue({alipay_account:t.alipay_account,alipay_surname:t.alipay_surname,crypto_chain_name:t.crypto_chain_name,crypto_address:t.crypto_address}),a(t.alipay_qr_code),x(t.crypto_qr_code))},[t,l]);const h=(e,t)=>{if(!e.type.startsWith("image/"))return U.Ay.error("\u53ea\u80fd\u4e0a\u4f20\u56fe\u7247\u6587\u4ef6\uff01"),!1;if(!(e.size/1024/1024<10))return U.Ay.error("\u56fe\u7247\u5927\u5c0f\u4e0d\u80fd\u8d85\u8fc710MB\uff01"),!1;const r=new FormData;r.append("qr_code",e),r.append("type",t);const n=new FileReader;return n.onload=e=>{"alipay"===t?a(e.target.result):x(e.target.result)},n.readAsDataURL(e),!1},m=e=>{console.log("\u9884\u89c8\u56fe\u7247:",e)},u=e=>{"alipay"===e?a(""):x("")},j={beforeUpload:e=>h(e,"alipay"),showUploadList:!1},p={beforeUpload:e=>h(e,"crypto"),showUploadList:!1};return(0,A.jsxs)("div",{children:[(0,A.jsx)(fe,{level:2,children:"\u6536\u6b3e\u914d\u7f6e"}),(0,A.jsxs)(L.A,{form:l,layout:"vertical",onFinish:async t=>{try{const r={alipay_account:t.alipay_account,alipay_surname:t.alipay_surname,alipay_qr_code:s,crypto_chain_name:t.crypto_chain_name,crypto_address:t.crypto_address,crypto_qr_code:c};await e((0,ve.YN)(r)).unwrap(),U.Ay.success("\u914d\u7f6e\u4fdd\u5b58\u6210\u529f")}catch(r){U.Ay.error("\u914d\u7f6e\u4fdd\u5b58\u5931\u8d25")}},children:[(0,A.jsx)(k.A,{title:"\u652f\u4ed8\u5b9d\u6536\u6b3e\u914d\u7f6e",style:{marginBottom:24},children:(0,A.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[(0,A.jsx)(L.A.Item,{label:"\u652f\u4ed8\u5b9d\u8d26\u53f7",name:"alipay_account",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u652f\u4ed8\u5b9d\u8d26\u53f7"}],children:(0,A.jsx)(V.A,{placeholder:"\u8bf7\u8f93\u5165\u652f\u4ed8\u5b9d\u8d26\u53f7"})}),(0,A.jsx)(L.A.Item,{label:"\u6536\u6b3e\u4eba\u59d3\u6c0f",name:"alipay_surname",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6536\u6b3e\u4eba\u59d3\u6c0f"}],children:(0,A.jsx)(V.A,{placeholder:"\u8bf7\u8f93\u5165\u6536\u6b3e\u4eba\u59d3\u6c0f"})}),(0,A.jsx)(L.A.Item,{label:"\u652f\u4ed8\u5b9d\u6536\u6b3e\u7801",children:(0,A.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[s?(0,A.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,A.jsx)(K.A,{width:100,height:100,src:s,style:{objectFit:"cover",borderRadius:8}}),(0,A.jsxs)(o.A,{children:[(0,A.jsx)(d.Ay,{type:"link",icon:(0,A.jsx)(J.A,{}),onClick:()=>m(s),children:"\u9884\u89c8"}),(0,A.jsx)(d.Ay,{type:"link",danger:!0,icon:(0,A.jsx)(Ae.A,{}),onClick:()=>u("alipay"),children:"\u5220\u9664"})]})]}):(0,A.jsx)(ye.A,{...j,children:(0,A.jsx)(d.Ay,{icon:(0,A.jsx)(ge.A,{}),children:"\u4e0a\u4f20\u6536\u6b3e\u7801"})}),(0,A.jsx)(we,{type:"secondary",children:"\u652f\u6301 JPG\u3001PNG\u3001GIF\u3001WebP \u683c\u5f0f\uff0c\u6700\u5927 10MB"})]})})]})}),(0,A.jsx)(S.A,{}),(0,A.jsx)(k.A,{title:"\u7ebf\u4e0a\u5730\u5740\u6536\u6b3e\u914d\u7f6e",style:{marginBottom:24},children:(0,A.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[(0,A.jsx)(L.A.Item,{label:"\u94fe\u540d",name:"crypto_chain_name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u94fe\u540d"}],children:(0,A.jsx)(V.A,{placeholder:"\u5982\uff1aTRC10/TRC20"})}),(0,A.jsx)(L.A.Item,{label:"\u6536\u6b3e\u5730\u5740",name:"crypto_address",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6536\u6b3e\u5730\u5740"}],children:(0,A.jsx)(V.A.TextArea,{placeholder:"\u8bf7\u8f93\u5165\u6536\u6b3e\u5730\u5740",rows:3})}),(0,A.jsx)(L.A.Item,{label:"\u7ebf\u4e0a\u6536\u6b3e\u7801",children:(0,A.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[c?(0,A.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,A.jsx)(K.A,{width:100,height:100,src:c,style:{objectFit:"cover",borderRadius:8}}),(0,A.jsxs)(o.A,{children:[(0,A.jsx)(d.Ay,{type:"link",icon:(0,A.jsx)(J.A,{}),onClick:()=>m(c),children:"\u9884\u89c8"}),(0,A.jsx)(d.Ay,{type:"link",danger:!0,icon:(0,A.jsx)(Ae.A,{}),onClick:()=>u("crypto"),children:"\u5220\u9664"})]})]}):(0,A.jsx)(ye.A,{...p,children:(0,A.jsx)(d.Ay,{icon:(0,A.jsx)(ge.A,{}),children:"\u4e0a\u4f20\u6536\u6b3e\u7801"})}),(0,A.jsx)(we,{type:"secondary",children:"\u652f\u6301 JPG\u3001PNG\u3001GIF\u3001WebP \u683c\u5f0f\uff0c\u6700\u5927 10MB"})]})})]})}),(0,A.jsx)(L.A.Item,{children:(0,A.jsx)(d.Ay,{type:"primary",htmlType:"submit",loading:r,icon:(0,A.jsx)(_e.A,{}),children:"\u4fdd\u5b58\u914d\u7f6e"})})]})]})},{Header:be,Sider:Ye,Content:Ie}=s.A,Ce=()=>{console.log("AdminDashboardPage \u7ec4\u4ef6\u5f00\u59cb\u52a0\u8f7d");const e=(0,i.wA)(),t=(0,l.Zp)(),{admin:r}=(0,i.d4)(e=>e.auth),[g,v]=(0,n.useState)(!1);(0,n.useEffect)(()=>{document.title="\u77e5\u884c\u8d22\u5e93"},[]),console.log("AdminDashboardPage \u72b6\u6001:",{admin:r,collapsed:g});const f=(0,A.jsxs)(a.A,{children:[(0,A.jsx)(a.A.Item,{icon:(0,A.jsx)(h.A,{}),children:"\u4e2a\u4eba\u4fe1\u606f"},"profile"),(0,A.jsx)(a.A.Item,{icon:(0,A.jsx)(m.A,{}),children:"\u8bbe\u7f6e"},"settings"),(0,A.jsx)(a.A.Divider,{}),(0,A.jsx)(a.A.Item,{icon:(0,A.jsx)(u.A,{}),onClick:()=>{e((0,y.ri)()),t("/admin")},children:"\u9000\u51fa\u767b\u5f55"},"logout")]}),w=[{key:"/admin/dashboard",icon:(0,A.jsx)(j.A,{}),label:"\u6570\u636e\u6982\u89c8"},{key:"/admin/orders",icon:(0,A.jsx)(p.A,{}),label:"\u8ba2\u5355\u7ba1\u7406"},{key:"/admin/sales",icon:(0,A.jsx)(h.A,{}),label:"\u9500\u552e\u7ba1\u7406"},{key:"/admin/customers",icon:(0,A.jsx)(h.A,{}),label:"\u5ba2\u6237\u7ba1\u7406"},{key:"/admin/payment-config",icon:(0,A.jsx)(m.A,{}),label:"\u6536\u6b3e\u914d\u7f6e"}];return(0,A.jsx)("div",{children:(0,A.jsxs)(s.A,{style:{minHeight:"100vh"},children:[(0,A.jsxs)(Ye,{trigger:null,collapsible:!0,collapsed:g,theme:"dark",style:{background:"linear-gradient(180deg, #2c3e50 0%, #34495e 100%)",boxShadow:"2px 0 8px rgba(0,0,0,0.15)"},children:[(0,A.jsx)("div",{style:{height:64,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:g?"16px":"18px",fontWeight:"bold",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",margin:"8px",borderRadius:"8px"},children:g?"ZXCK":"\u77e5\u884c\u8d22\u5e93"}),(0,A.jsx)(a.A,{theme:"dark",mode:"inline",defaultSelectedKeys:["/admin/dashboard"],items:w,onClick:e=>{let{key:r}=e;t(r)}})]}),(0,A.jsxs)(s.A,{children:[(0,A.jsxs)(be,{style:{padding:"0 24px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"white"},children:[(0,A.jsx)(d.Ay,{type:"text",icon:g?"\u2630":"\u2715",onClick:()=>v(!g),tabIndex:0,style:{fontSize:"16px",width:64,height:64}}),(0,A.jsxs)(o.A,{children:[(0,A.jsxs)("span",{style:{color:"white",fontWeight:"bold"},children:["\u6b22\u8fce\uff0c",null===r||void 0===r?void 0:r.username]}),(0,A.jsx)(c.A,{overlay:f,placement:"bottomRight",children:(0,A.jsx)(x.A,{icon:(0,A.jsx)(h.A,{}),style:{cursor:"pointer",backgroundColor:"rgba(255,255,255,0.2)"}})})]})]}),(0,A.jsx)(Ie,{style:{margin:"16px",padding:"24px",background:"white",borderRadius:"16px",minHeight:"calc(100vh - 96px)",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",border:"1px solid #f0f0f0"},children:(0,A.jsx)(_,{children:(0,A.jsxs)(l.BV,{children:[(0,A.jsx)(l.qh,{path:"dashboard",element:(0,A.jsx)(H,{})}),(0,A.jsx)(l.qh,{path:"",element:(0,A.jsx)(H,{})}),(0,A.jsx)(l.qh,{path:"orders",element:(0,A.jsx)(le,{})}),(0,A.jsx)(l.qh,{path:"sales",element:(0,A.jsx)(he,{})}),(0,A.jsx)(l.qh,{path:"customers",element:(0,A.jsx)(pe,{})}),(0,A.jsx)(l.qh,{path:"payment-config",element:(0,A.jsx)(ke,{})})]})})})]})]})})}}}]);
//# sourceMappingURL=604.2856d091.chunk.js.map